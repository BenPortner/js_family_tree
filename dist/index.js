var ba=Object.create;var kr=Object.defineProperty;var wa=Object.getOwnPropertyDescriptor;var Ea=Object.getOwnPropertyNames;var Ia=Object.getPrototypeOf,Ca=Object.prototype.hasOwnProperty;var Ma=(t,e,n)=>e in t?kr(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Ba=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var Sa=(t,e,n,l)=>{if(e&&typeof e=="object"||typeof e=="function")for(let f of Ea(e))!Ca.call(t,f)&&f!==n&&kr(t,f,{get:()=>e[f],enumerable:!(l=wa(e,f))||l.enumerable});return t};var ka=(t,e,n)=>(n=t!=null?ba(Ia(t)):{},Sa(e||!t||!t.__esModule?kr(n,"default",{value:t,enumerable:!0}):n,t));var yn=(t,e,n)=>(Ma(t,typeof e!="symbol"?e+"":e,n),n);var ls=Ba((hr,us)=>{(function(t,e){typeof hr=="object"&&typeof us<"u"?e(hr):typeof define=="function"&&define.amd?define(["exports"],e):e(t.d3=t.d3||{})})(hr,function(t){"use strict";function e(){function r(i,s){let o=Math.max(...i.map(a=>(a[0].x=0,a.slice(1).forEach((u,h)=>{let d=a[h];u.x=d.x+s(d,u)}),a[a.length-1].x)));return i.forEach(a=>{let u=a[a.length-1].x/2;a.forEach(h=>{h.x=(h.x-u)/o+.5})}),i}return r}function n(){let r=l;function i(s,o){s.forEach(h=>h.forEach(d=>d.degree=d.children.length+(d.data?0:-3))),s.forEach(h=>h.forEach(d=>d.children.forEach(c=>++c.degree))),s[0][0].x=0,s[0].slice(1).forEach((h,d)=>{let c=s[0][d];h.x=c.x+o(c,h)}),s.slice(0,s.length-1).forEach((h,d)=>{let c=s[d+1];r(h,c),c.map((g,p)=>[g,p]).sort(([g,p],[x,y])=>g.degree===x.degree?p-y:x.degree-g.degree).forEach(([g,p])=>{c.slice(p+1).reduce((x,y)=>(y.x=Math.max(y.x,x.x+o(x,y)),y),g),c.slice(0,p).reverse().reduce((x,y)=>(y.x=Math.min(y.x,x.x-o(y,x)),y),g)})});let a=Math.min(...s.map(h=>Math.min(...h.map(d=>d.x)))),u=Math.max(...s.map(h=>Math.max(...h.map(d=>d.x))))-a;return s.forEach(h=>h.forEach(d=>d.x=(d.x-a)/u)),s.forEach(h=>h.forEach(d=>delete d.degree)),s}return i}function l(r,i){i.forEach(s=>{s.x=0,s._count=0}),r.forEach(s=>s.children.forEach(o=>o.x+=(s.x-o.x)/++o._count)),i.forEach(s=>delete s._count)}let f=1e-60,m,v;do f+=f,m=1+.1*f,v=1+.2*f;while(m<=1||v<=1);var E=f;function I(r,i,s){let o,a;for(let u=1;u<=s;u+=1){r[u][u]=1/r[u][u],a=-r[u][u];for(let h=1;h<u;h+=1)r[h][u]*=a;if(o=u+1,s<o)break;for(let h=o;h<=s;h+=1){a=r[u][h],r[u][h]=0;for(let d=1;d<=u;d+=1)r[d][h]+=a*r[d][u]}}}var C=I;function S(r,i,s,o){let a,u;for(a=1;a<=s;a+=1){u=0;for(let h=1;h<a;h+=1)u+=r[h][a]*o[h];o[a]=(o[a]-u)/r[a][a]}for(let h=1;h<=s;h+=1){a=s+1-h,o[a]/=r[a][a],u=-o[a];for(let d=1;d<a;d+=1)o[d]+=u*r[d][a]}}var N=S;function R(r,i,s,o){let a,u,h;for(let d=1;d<=s;d+=1){if(o[1]=d,h=0,a=d-1,a<1){if(h=r[d][d]-h,h<=0)break;r[d][d]=Math.sqrt(h)}else{for(let c=1;c<=a;c+=1){u=r[c][d];for(let g=1;g<c;g+=1)u-=r[g][d]*r[g][c];u/=r[c][c],r[c][d]=u,h+=u*u}if(h=r[d][d]-h,h<=0)break;r[d][d]=Math.sqrt(h)}o[1]=0}}var P=R;function q(r,i,s,o,a,u,h,d,c,g,p,x,y,b=0,V,w,z){let B,k,T,$,A,D,tt,J,j,X,ft,St,$t,kt,Yt=Math.min(o,p),nt=2*o+Yt*(Yt+5)/2+2*p+1;for(let _=1;_<=o;_+=1)w[_]=i[_];for(let _=o+1;_<=nt;_+=1)w[_]=0;for(let _=1;_<=p;_+=1)y[_]=0,u[_]=0;let de=[];if(z[1]===0){if(P(r,s,o,de),de[1]!==0){z[1]=2;return}N(r,s,o,i),C(r,s,o)}else{for(let _=1;_<=o;_+=1){a[_]=0;for(let L=1;L<=_;L+=1)a[_]+=r[L][_]*i[L]}for(let _=1;_<=o;_+=1){i[_]=0;for(let L=_;L<=o;L+=1)i[_]+=r[_][L]*a[L]}}h[1]=0;for(let _=1;_<=o;_+=1){a[_]=i[_],h[1]+=w[_]*a[_],w[_]=0;for(let L=_+1;L<=o;L+=1)r[L][_]=0}h[1]=-h[1]/2,z[1]=0;let Vt=o,zt=Vt+o,at=zt+Yt,Qt=at+Yt+1,Gt=Qt+Yt*(Yt+1)/2,Sr=Gt+p;for(let _=1;_<=p;_+=1){D=0;for(let L=1;L<=o;L+=1)D+=d[L][_]*d[L][_];w[Sr+_]=Math.sqrt(D)}$=b,V[1]=0,V[2]=0;function ga(){V[1]+=1,nt=Gt;for(let _=1;_<=p;_+=1){nt+=1,D=-c[_];for(let L=1;L<=o;L+=1)D+=d[L][_]*a[L];if(Math.abs(D)<E&&(D=0),_>x)w[nt]=D;else if(w[nt]=-Math.abs(D),D>0){for(let L=1;L<=o;L+=1)d[L][_]=-d[L][_];c[_]=-c[_]}}for(let _=1;_<=$;_+=1)w[Gt+y[_]]=0;T=0,A=0;for(let _=1;_<=p;_+=1)w[Gt+_]<A*w[Sr+_]&&(T=_,A=w[Gt+_]/w[Sr+_]);if(T===0){for(let _=1;_<=$;_+=1)u[y[_]]=w[at+_];return 999}return 0}function xa(){for(let _=1;_<=o;_+=1){D=0;for(let L=1;L<=o;L+=1)D+=r[L][_]*d[L][T];w[_]=D}B=Vt;for(let _=1;_<=o;_+=1)w[B+_]=0;for(let _=$+1;_<=o;_+=1)for(let L=1;L<=o;L+=1)w[B+L]=w[B+L]+r[L][_]*w[_];St=!0;for(let _=$;_>=1;_-=1){D=w[_],nt=Qt+_*(_+3)/2,B=nt-_;for(let L=_+1;L<=$;L+=1)D-=w[nt]*w[zt+L],nt+=L;D/=w[B],w[zt+_]=D,!(y[_]<=x)&&(D<=0||(St=!1,k=_))}if(!St){tt=w[at+k]/w[zt+k];for(let _=1;_<=$;_+=1)y[_]<=x||w[zt+_]<=0||(A=w[at+_]/w[zt+_],A<tt&&(tt=A,k=_))}D=0;for(let _=Vt+1;_<=Vt+o;_+=1)D+=w[_]*w[_];if(Math.abs(D)<=E){if(St)return z[1]=1,999;for(let _=1;_<=$;_+=1)w[at+_]=w[at+_]-tt*w[zt+_];return w[at+$+1]=w[at+$+1]+tt,700}D=0;for(let _=1;_<=o;_+=1)D+=w[Vt+_]*d[_][T];J=-w[Gt+T]/D,$t=!0,St||tt<J&&(J=tt,$t=!1);for(let _=1;_<=o;_+=1)a[_]+=J*w[Vt+_],Math.abs(a[_])<E&&(a[_]=0);h[1]+=J*D*(J/2+w[at+$+1]);for(let _=1;_<=$;_+=1)w[at+_]=w[at+_]-J*w[zt+_];if(w[at+$+1]=w[at+$+1]+J,$t){$+=1,y[$]=T,nt=Qt+($-1)*$/2+1;for(let _=1;_<=$-1;_+=1)w[nt]=w[_],nt+=1;if($===o)w[nt]=w[o];else{for(let _=o;_>=$+1;_-=1)if(w[_]!==0&&(j=Math.max(Math.abs(w[_-1]),Math.abs(w[_])),X=Math.min(Math.abs(w[_-1]),Math.abs(w[_])),w[_-1]>=0?A=Math.abs(j*Math.sqrt(1+X*X/(j*j))):A=-Math.abs(j*Math.sqrt(1+X*X/(j*j))),j=w[_-1]/A,X=w[_]/A,j!==1))if(j===0){w[_-1]=X*A;for(let L=1;L<=o;L+=1)A=r[L][_-1],r[L][_-1]=r[L][_],r[L][_]=A}else{w[_-1]=A,ft=X/(1+j);for(let L=1;L<=o;L+=1)A=j*r[L][_-1]+X*r[L][_],r[L][_]=ft*(r[L][_-1]+A)-r[L][_],r[L][_-1]=A}w[nt]=w[$]}}else{D=-c[T];for(let _=1;_<=o;_+=1)D+=a[_]*d[_][T];if(T>x)w[Gt+T]=D;else if(w[Gt+T]=-Math.abs(D),D>0){for(let _=1;_<=o;_+=1)d[_][T]=-d[_][T];c[T]=-c[T]}return 700}return 0}function ya(){if(nt=Qt+k*(k+1)/2+1,B=nt+k,w[B]===0||(j=Math.max(Math.abs(w[B-1]),Math.abs(w[B])),X=Math.min(Math.abs(w[B-1]),Math.abs(w[B])),w[B-1]>=0?A=Math.abs(j*Math.sqrt(1+X*X/(j*j))):A=-Math.abs(j*Math.sqrt(1+X*X/(j*j))),j=w[B-1]/A,X=w[B]/A,j===1))return 798;if(j===0){for(let _=k+1;_<=$;_+=1)A=w[B-1],w[B-1]=w[B],w[B]=A,B+=_;for(let _=1;_<=o;_+=1)A=r[_][k],r[_][k]=r[_][k+1],r[_][k+1]=A}else{ft=X/(1+j);for(let _=k+1;_<=$;_+=1)A=j*w[B-1]+X*w[B],w[B]=ft*(w[B-1]+A)-w[B],w[B-1]=A,B+=_;for(let _=1;_<=o;_+=1)A=j*r[_][k]+X*r[_][k+1],r[_][k+1]=ft*(r[_][k]+A)-r[_][k+1],r[_][k]=A}return 0}function _a(){B=nt-k;for(let _=1;_<=k;_+=1)w[B]=w[nt],nt+=1,B+=1;return w[at+k]=w[at+k+1],y[k]=y[k+1],k+=1,k<$?797:0}function xn(){return w[at+$]=w[at+$+1],w[at+$+1]=0,y[$]=0,$-=1,V[2]+=1,0}for(kt=0;;){if(kt=ga(),kt===999)return;for(;kt=xa(),kt!==0;){if(kt===999)return;if(kt===700)if(k===$)xn();else{for(;ya(),kt=_a(),kt===797;);xn()}}}}var K=q;function it(r,i,s,o=[],a=0,u=[0,0]){let h=[],d=[],c=[],g=[],p=[],x=[],y="",b=r.length-1,V=s[1].length-1;if(!o)for(let B=1;B<=V;B+=1)o[B]=0;if(b!==r[1].length-1&&(y="Dmat is not symmetric!"),b!==i.length-1&&(y="Dmat and dvec are incompatible!"),b!==s.length-1&&(y="Amat and dvec are incompatible!"),V!==o.length-1&&(y="Amat and bvec are incompatible!"),(a>V||a<0)&&(y="Value of meq is invalid!"),y!=="")return{message:y};for(let B=1;B<=V;B+=1)d[B]=0,g[B]=0;let w=0,z=Math.min(b,V);for(let B=1;B<=b;B+=1)c[B]=0;h[1]=0;for(let B=1;B<=2*b+z*(z+5)/2+2*V+1;B+=1)p[B]=0;for(let B=1;B<=2;B+=1)x[B]=0;return K(r,i,b,b,c,g,h,s,o,b,V,a,d,w,x,p,u),u[1]===1&&(y="constraints are inconsistent, no solution!"),u[1]===2&&(y="matrix D in quadratic function is not positive definite!"),{solution:c,Lagrangian:g,value:h,unconstrained_solution:i,iterations:x,iact:d,message:y}}var Y=it,lt={solveQP:Y};let{solveQP:dt}=lt;var wt=function(r,i,s,o,a=0,u=!1){let h=[null].concat(r.map(B=>[null].concat(B))),d=[null].concat(i.map(B=>-B)),c=[null].concat(s.length===0?new Array(r.length).fill([null]):s[0].map((B,k)=>[null].concat(s.map(T=>-T[k])))),g=[null].concat(o.map(B=>-B)),{solution:p,Lagrangian:x,value:y,unconstrained_solution:b,iterations:V,iact:w,message:z}=dt(h,d,c,g,a,[,+u]);if(z.length>0)throw new Error(z);{p.shift(),x.shift(),b.shift(),w.push(0);let B=w.slice(1,w.indexOf(0)).map(A=>A-1),[,k]=y,[,T,$]=V;return{solution:p,lagrangian:x,unconstrained:b,iterations:T,inactive:$,active:B,value:k}}},xt=wt;function vt(r){let i={},s=0;return r.forEach(o=>o.forEach(a=>i[a.id]=s++)),i}function Et(r,i,s){let o=1+Math.max(...Object.values(i)),a=[],u=[];return r.forEach(h=>h.slice(0,h.length-1).forEach((d,c)=>{let g=h[c+1],p=i[d.id],x=i[g.id],y=new Array(o).fill(0);y[p]=1,y[x]=-1,a.push(y),u.push(-s(d,g))})),[a,u]}function Ht(r,i,s,o){r[s][s]+=o,r[s][i]-=o,r[i][s]-=o,r[i][i]+=o}function jt(r,i,s,o,a){r[o][o]+=a,r[o][s]-=2*a,r[o][i]+=a,r[s][o]-=2*a,r[s][s]+=4*a,r[s][i]-=2*a,r[i][o]+=a,r[i][s]-=2*a,r[i][i]+=a}function Xt(r,i,s,o,a=0){i.pop(),r.pop(),r.forEach(h=>h.pop()),s.forEach(h=>h.pop());let{solution:u}=xt(r,i,s,o,a);return u.push(0),u}function fe(r,i,s){let o=Math.min(...s),a=Math.max(...s)-o;r.forEach(u=>u.forEach(h=>h.x=(s[i[h.id]]-o)/a))}function pr(r){if(r<0||r>=1)throw new Error(`weight must be in [0, 1), but was ${r}`);return r}function mr(){let r=.5;function i(s,o){let a=vt(s),u=Object.keys(a).length,[h,d]=Et(s,a,o),c=new Array(u).fill(0),g=new Array(u).fill(null).map(()=>new Array(u).fill(0));s.forEach(x=>x.forEach(y=>{let b=a[y.id];y.children.forEach(V=>{let w=a[V.id];Ht(g,b,w,1-r)})})),s.forEach(x=>x.forEach(y=>{let b=a[y.id];y.children.forEach(V=>{let w=a[V.id];V.children.forEach(z=>{let B=a[z.id];jt(g,b,w,B,r)})})}));let p=Xt(g,c,h,d);return fe(s,a,p),s}return i.weight=function(s){return arguments.length?(r=pr(s),i):r},i}function M(){function r(i,s){if(!i.every(x=>x.reduce((y,b)=>y+!!b.data,0)===1))throw new Error("coordTopological() only works with a topological ordering");let o={},a=0;i.forEach(x=>x.forEach(y=>y.data||(o[y.id]=a++))),i.forEach(x=>x.forEach(y=>o[y.id]===void 0&&(o[y.id]=a)));let u=++a,[h,d]=Et(i,o,s),c=new Array(u).fill(0),g=new Array(u).fill(null).map(()=>new Array(u).fill(0));i.forEach(x=>x.forEach(y=>{let b=o[y.id];y.children.forEach(V=>{if(!V.data){let w=o[V.id];V.children.forEach(z=>{let B=o[z.id];jt(g,b,w,B,1)})}})}));let p=Xt(g,c,h,d);return fe(i,o,p),i}return r}function F(){function r(i,s){let o=vt(i),a=Object.keys(o).length,[u,h]=Et(i,o,s),d=new Array(a).fill(0),c=new Array(a).fill(null).map(()=>new Array(a).fill(0));i.forEach(p=>p.forEach(x=>{let y=o[x.id];x.children.forEach(b=>{let V=o[b.id];x.data&&Ht(c,y,V,1),b.data&&Ht(c,y,V,1)})})),i.forEach(p=>p.forEach(x=>{let y=o[x.id];x.children.forEach(b=>{if(!b.data){let V=o[b.id];b.children.forEach(w=>{let z=o[w.id];jt(c,y,V,z,1)})}})}));let g=Xt(c,d,u,h);return fe(i,o,g),i}return r}function O(){function r(s,o,a){let u=Math.max(...s.map(g=>Math.max(...g.map(p=>p.columnIndex+1)))),h=Array.from(Array(u).keys()).map((g,p)=>p).map(o),d=Array.from(Array(u).keys()).map((g,p)=>p).map(a),c=Math.max(...s.map(g=>(g.forEach(p=>{p.x0=i(h,d,p.columnIndex),p.x1=p.x0+h[p.columnIndex]}),Math.max(...g.map(p=>p.x1)))));return s.forEach(g=>{g.forEach(p=>{p.x0=p.x0/c,p.x1=p.x1/c})}),s}return r;function i(s,o,a){let u=s.filter((d,c)=>c<a),h=o.filter((d,c)=>c<a);return u.concat(h).reduce((d,c)=>d+c,0)}}function H(){function r(i){i.forEach(s=>{s.forEach((o,a)=>o.columnIndex=a)})}return r}function G(){function r(i){let s=Math.max(...i.map(o=>o.length));i.forEach(o=>{let a=o.length,u=Math.floor((s-a)/2);o.forEach((h,d)=>h.columnIndex=u+d)})}return r}function U(){let r=!1;function i(s){if(s.length==0)return;let o=Math.max(...s.map(c=>c.length)),a=s.findIndex(c=>c.length===o);s[a].forEach((c,g)=>c.columnIndex=g);for(let c=a-1;c>=0;c--)u(s[c]);for(let c=a+1;c<s.length;c++)h(s[c]);function u(c){let g;if(c.length===o)g=c.map((p,x)=>x);else{let p=c.map((x,y)=>{if(x.children==null||x.children.length===0)return y;let b=x.children.map(V=>V.columnIndex);return r?b[Math.floor((b.length-1)/2)]:Math.min(...b)});g=d(p)}c.forEach((p,x)=>p.columnIndex=g[x])}function h(c){let g;if(c.length===o)g=c.map((p,x)=>x);else{let p=c.map((x,y)=>{if(x.parents==null||x.parents.length===0)return y;let b=x.parents.map(V=>V.columnIndex);return r?b[Math.floor((b.length-1)/2)]:Math.min(...b)});g=d(p)}c.forEach((p,x)=>p.columnIndex=g[x])}function d(c){if(!c.every(y=>isFinite(y)))throw"columnComplex: non-finite column index encountered";let g=-1;c=c.map(y=>(y<=g&&(y=g+1),g=y,y));let x=Math.max(...c)-(o-1);return x>0&&(c=c.map((y,b)=>Math.max(y-x,b))),c}}return i.center=function(s){return arguments.length?(r=s,i):r},i}function W(){let r=!1;function i(s){if(s.length==0)return;let o=[];s.forEach(d=>d.forEach(c=>{(c.parents==null||c.parents.length===0)&&o.push(c)}));let a=0;o.forEach(d=>{let c=u(d);d.columnIndex=a+(r?Math.floor((c-1)/2):0),h(d,a),a+=c});function u(d){return d.children.length===0?1:d.children.reduce((c,g)=>c+u(g),0)}function h(d,c){let g=d.children.map(u),p=c;d.children.forEach((x,y)=>{x.columnIndex===void 0&&(x.columnIndex=p+(r?Math.floor((g[y]-1)/2):0),h(x,p),p+=g[y])})}}return i.center=function(s){return arguments.length?(r=s,i):r},i}function Q(){let r=[];return this.eachChildLinks(i=>r.push(i)),r}function rt(){return this.eachAfter(r=>{r.children.length?(r._leaves=Object.assign({},...r.children.map(i=>i._leaves)),r.value=Object.keys(r._leaves).length):(r._leaves={[r.id]:!0},r.value=1)}),this.each(r=>delete r._leaves),this}function It(){if(this.id!==void 0)return!0;let r=this.roots().map(o=>o.descendants().map(a=>a.id)),i=r.map(()=>!1),s=[i.length-1];for(;s.length;){let o=s.pop();if(i[o])continue;let a={};i[o]=!0,r[o].forEach(u=>a[u]=!0),r.forEach((u,h)=>{u.some(d=>a[d])&&s.push(h)})}return i.every(o=>o)}function ot(){return this.each(r=>{r.children.forEach(i=>(i._parents||(i._parents=[])).push(r))}),this.eachBefore(r=>{r.value=Math.max(0,...(r._parents||[]).map(i=>1+i.value))}),this.each(r=>delete r._parents),this}function yt(){let r=[];return this.each(i=>r.push(i)),r}function Mt(r){let i=[];return this.eachBefore(s=>i.push(s)),i.reverse().forEach(r),this}function _t(r){this.each(a=>a._num_before=0),this.each(a=>a.children.forEach(u=>++u._num_before));let i=this.roots(),s,o=0;for(;s=i.pop();)r(s,o++),s.children.forEach(a=>--a._num_before||i.push(a));return this.each(a=>delete a._num_before),this}function Bt(r){let i={},s=[],o=this.roots(),a=0;do{s=o.reverse(),o=[];let u;for(;u=s.pop();)i[u.id]||(i[u.id]=!0,r(u,a++),o.push(...u.children))}while(o.length)}function ce(r){if(this.id!==void 0){let i=0;this.children.forEach((s,o)=>r({source:this,target:s,data:this._childLinkData[o]},i++))}return this}function hs(r){let i=this.roots(),s={},o,a=0;for(;o=i.pop();)s[o.id]||(s[o.id]=!0,r(o,a++),i.push(...o.children));return this}function fs(r){let i=0;return this.each(s=>s.eachChildLinks(o=>r(o,i++))),this}function cs(r){let i={};return r.forEach(s=>i[s]=!0),i}function Jr(r){let i={};return r.each(s=>i[s.id]=[s.data,cs(s.children.map(o=>o.id))]),i}function ds(r,i){return Object.keys(r).length===Object.keys(i).length&&Object.keys(r).every(s=>i[s])}function ps(r){let i=Jr(this),s=Jr(r);return Object.keys(i).length===Object.keys(s).length&&Object.entries(i).every(([o,[a,u]])=>{let h=s[o];if(!h)return!1;let[d,c]=h;return a===d&&ds(u,c)})}let Qr={};function ms(r){try{this.each((i,s)=>{if(!r(i,s))throw Qr})}catch(i){if(i===Qr)return!1;throw i}return!0}function vs(){return this.eachAfter(r=>r.value=Math.max(0,...r.children.map(i=>1+i.value)))}function gs(){let r=[];return this.eachLinks(i=>r.push(i)),r}function xs(r,i){let s=i;return this.each((o,a)=>{s=r(s,o,a)}),s}function ys(){return this.id===void 0?this.children.slice():[this]}function _s(){return this.reduce(r=>r+1,0)}let tn={};function bs(r){try{this.each(i=>{if(r(i))throw tn})}catch(i){if(i===tn)return!0;throw i}return!1}function ws(r){return this.eachAfter((i,s)=>{let o=+r(i.data,s);i._descendants=Object.assign({[i.id]:o},...i.children.map(a=>a._descendants)),i.value=Object.values(i._descendants).reduce((a,u)=>a+u)}),this.each(i=>delete i._descendants),this}function pt(r,i){this.id=r,this.data=i,this.children=[],this._childLinkData=[]}function Es(){let r=[],i=[],s={};if(this.each(o=>{r.push(o);let a=new pt(o.id,o.data);i.push(a),s[a.id]=a}),i.forEach((o,a)=>{let u=r[a];o.children=u.children.map(h=>s[h.id])}),this.id===void 0){let o=new pt(void 0,void 0);o.children=this.children.map(a=>s[a.id])}else return s[this.id]}function Is(){let r=[],i=[],s={},o=new pt(void 0,void 0);return this.each(a=>{r.push(a);let u=new pt(a.id,a.data);i.push(u),s[u.id]=u,a.children.length||o.children.push(u)}),i.forEach((a,u)=>{let h=r[u];h.children.map((d,c)=>{let g=s[d.id];g.children.push(a),g._childLinkData.push(h._childLinkData[c])})}),o.children.length>1?o:o.children[0]}pt.prototype={constructor:pt,childLinks:Q,copy:Es,count:rt,connected:It,depth:ot,descendants:yt,each:hs,eachAfter:Mt,eachBefore:_t,eachBreadth:Bt,eachChildLinks:ce,eachLinks:fs,equals:ps,every:ms,height:vs,links:gs,reduce:xs,reverse:Is,roots:ys,size:_s,some:bs,sum:ws};function en(r){if(r.id!==void 0)throw new Error("invalid format for verification");if(!r.children.length)throw new Error("no roots");let i={},s={},o;function a(h){if(i[h.id])return!1;if(s[h.id])return o=h.id,[h.id];{s[h.id]=!0;let d=h.children.reduce((c,g)=>c||a(g),!1);return delete s[h.id],i[h.id]=!0,d&&o&&d.push(h.id),o===h.id&&(o=void 0),d}}let u=r.id===void 0?r.children.reduce((h,d)=>h||a(d),!1):a(r);if(u)throw new Error("dag contained a cycle: "+u.reverse().join(" -> "));if(r.each(h=>{if(h.id.indexOf("\0")>=0)throw new Error("node id contained null character");if(!h.data)throw new Error("node contained falsy data")}),r.links().some(({data:h})=>!h))throw new Error("dag had falsy link data")}function rn(){if(arguments.length)throw Error(`got arguments to dagStratify(${arguments}), but constructor takes no aruguments. These were probably meant as data which should be called as dagStratify()(...)`);let r=Cs,i=Ms,s=Bs;function o(a){if(!a.length)throw new Error("can't stratify empty data");let u=a.map((c,g)=>{let p=r(c,g);try{return new pt(p.toString(),c)}catch{throw Error(`node ids must have toString but got ${p} from ${c}`)}}),h={};u.forEach(c=>{if(h[c.id])throw new Error("found a duplicate id: "+c.id);h[c.id]=c});let d=new pt(void 0,void 0);return u.forEach(c=>{let g=i(c.data)||[];g.forEach(p=>{let x=h[p];if(!x)throw new Error("missing id: "+p);return x.children.push(c),x._childLinkData.push(s(x.data,c.data)),x}),g.length||d.children.push(c)}),en(d),d.children.length>1?d:d.children[0]}return o.id=function(a){return arguments.length?(r=a,o):r},o.parentIds=function(a){return arguments.length?(i=a,o):i},o.linkData=function(a){return arguments.length?(s=a,o):s},o}function Cs(r){return r.id}function Ms(r){return r.parentIds}function Bs(){return{}}function Ss(){if(arguments.length)throw Error(`got arguments to dagConnect(${arguments}), but constructor takes no aruguments. These were probably meant as data which should be called as dagConnect()(...)`);let r=ks,i=Vs,s=zs;function o(u,h){return s(h.linkData[u.id])}function a(u){if(!u.length)throw new Error("can't create graph from empty data");let h={};return u.forEach(d=>{let c=r(d),g=i(d);h[c]||(h[c]={id:c,parentIds:[],linkData:{}});let p=h[g]||(h[g]={id:g,parentIds:[],linkData:{}});p.parentIds.push(c),p.linkData[c]=d}),rn().linkData(o)(Object.values(h))}return a.sourceAccessor=function(u){return arguments.length?(r=u,a):r},a.targetAccessor=function(u){return arguments.length?(i=u,a):i},a.linkData=function(u){return arguments.length?(s=u,a):s},a}function ks(r){return r[0]}function Vs(r){return r[1]}function zs(r){return r}function Os(){if(arguments.length)throw Error(`got arguments to dagHierarchy(${arguments}), but constructor takes no aruguments. These were probably meant as data which should be called as dagHierarchy()(...)`);let r=As,i=Ts,s=$s;function o(...a){if(!a.length)throw new Error("must pass at least one node");let u={},h=[];function d(p){let x;try{x=r(p).toString()}catch{throw Error(`node ids must have toString but got ${r(p)} from ${p}`)}let y;if(!(y=u[x]))y=new pt(x,p),h.push(y),u[x]=y;else if(p!==y.data)throw new Error("found a duplicate id: "+x);return y}let c=new pt(void 0,void 0),g;for(c.children=a.map(d);g=h.pop();)g.children=(i(g.data)||[]).map(d),g._childLinkData=g.children.map(p=>s(g.data,p.data));return en(c),c.children.length>1?c:c.children[0]}return o.id=function(a){return arguments.length?(r=a,o):r},o.children=function(a){return arguments.length?(i=a,o):i},o.linkData=function(a){return arguments.length?(s=a,o):s},o}function As(r){return r.id}function Ts(r){return r.children}function $s(){return{}}function nn(r,i,s,o){this.feasible=s,this.evaluation=i,this.bounded=o,this._tableau=r}var vr=nn;nn.prototype.generateSolutionSet=function(){for(var r={},i=this._tableau,s=i.varIndexByRow,o=i.variablesPerIndex,a=i.matrix,u=i.rhsColumn,h=i.height-1,d=Math.round(1/i.precision),c=1;c<=h;c+=1){var g=s[c],p=o[g];if(!(p===void 0||p.isSlack===!0)){var x=a[c][u];r[p.id]=Math.round((Number.EPSILON+x)*d)/d}}return r};function Ae(r,i,s,o,a){vr.call(this,r,i,s,o),this.iter=a}var Ns=Ae;Ae.prototype=Object.create(vr.prototype),Ae.constructor=Ae;function Tt(r){this.model=null,this.matrix=null,this.width=0,this.height=0,this.costRowIndex=0,this.rhsColumn=0,this.variablesPerIndex=[],this.unrestrictedVars=null,this.feasible=!0,this.evaluation=0,this.simplexIters=0,this.varIndexByRow=null,this.varIndexByCol=null,this.rowByVarIndex=null,this.colByVarIndex=null,this.precision=r||1e-8,this.optionalObjectives=[],this.objectivesByPriority={},this.savedState=null,this.availableIndexes=[],this.lastElementIndex=0,this.variables=null,this.nVars=0,this.bounded=!0,this.unboundedVarIndex=null,this.branchAndCutIterations=0}var Z=Tt;Tt.prototype.solve=function(){return this.model.getNumberOfIntegerVariables()>0?this.branchAndCut():this.simplex(),this.updateVariableValues(),this.getSolution()};function gr(r,i){this.priority=r,this.reducedCosts=new Array(i);for(var s=0;s<i;s+=1)this.reducedCosts[s]=0}gr.prototype.copy=function(){var r=new gr(this.priority,this.reducedCosts.length);return r.reducedCosts=this.reducedCosts.slice(),r},Tt.prototype.setOptionalObjective=function(r,i,s){var o=this.objectivesByPriority[r];if(o===void 0){var a=Math.max(this.width,i+1);o=new gr(r,a),this.objectivesByPriority[r]=o,this.optionalObjectives.push(o),this.optionalObjectives.sort(function(u,h){return u.priority-h.priority})}o.reducedCosts[i]=s},Tt.prototype.initialize=function(r,i,s,o){this.variables=s,this.unrestrictedVars=o,this.width=r,this.height=i;for(var a=new Array(r),u=0;u<r;u++)a[u]=0;this.matrix=new Array(i);for(var h=0;h<i;h++)this.matrix[h]=a.slice();this.varIndexByRow=new Array(this.height),this.varIndexByCol=new Array(this.width),this.varIndexByRow[0]=-1,this.varIndexByCol[0]=-1,this.nVars=r+i-2,this.rowByVarIndex=new Array(this.nVars),this.colByVarIndex=new Array(this.nVars),this.lastElementIndex=this.nVars},Tt.prototype._resetMatrix=function(){var r=this.model.variables,i=this.model.constraints,s=r.length,o=i.length,a,u,h=this.matrix[0],d=this.model.isMinimization===!0?-1:1;for(a=0;a<s;a+=1){var c=r[a],g=c.priority,p=d*c.cost;g===0?h[a+1]=p:this.setOptionalObjective(g,a+1,p),u=r[a].index,this.rowByVarIndex[u]=-1,this.colByVarIndex[u]=a+1,this.varIndexByCol[a+1]=u}for(var x=1,y=0;y<o;y+=1){var b=i[y],V=b.index;this.rowByVarIndex[V]=x,this.colByVarIndex[V]=-1,this.varIndexByRow[x]=V;var w,z,B,k=b.terms,T=k.length,$=this.matrix[x++];if(b.isUpperBound){for(w=0;w<T;w+=1)z=k[w],B=this.colByVarIndex[z.variable.index],$[B]=z.coefficient;$[0]=b.rhs}else{for(w=0;w<T;w+=1)z=k[w],B=this.colByVarIndex[z.variable.index],$[B]=-z.coefficient;$[0]=-b.rhs}}},Tt.prototype.setModel=function(r){this.model=r;var i=r.nVariables+1,s=r.nConstraints+1;return this.initialize(i,s,r.variables,r.unrestrictedVariables),this._resetMatrix(),this},Tt.prototype.getNewElementIndex=function(){if(this.availableIndexes.length>0)return this.availableIndexes.pop();var r=this.lastElementIndex;return this.lastElementIndex+=1,r},Tt.prototype.density=function(){for(var r=0,i=this.matrix,s=0;s<this.height;s++)for(var o=i[s],a=0;a<this.width;a++)o[a]!==0&&(r+=1);return r/(this.height*this.width)},Tt.prototype.setEvaluation=function(){var r=Math.round(1/this.precision),i=this.matrix[this.costRowIndex][this.rhsColumn],s=Math.round((Number.EPSILON+i)*r)/r;this.evaluation=s,this.simplexIters===0&&(this.bestPossibleEval=s)},Tt.prototype.getSolution=function(){var r=this.model.isMinimization===!0?this.evaluation:-this.evaluation;return this.model.getNumberOfIntegerVariables()>0?new Ns(this,r,this.feasible,this.bounded,this.branchAndCutIterations):new vr(this,r,this.feasible,this.bounded)},Z.prototype.simplex=function(){return this.bounded=!0,this.phase1(),this.feasible===!0&&this.phase2(),this},Z.prototype.phase1=function(){for(var r=this.model.checkForCycles,i=[],s=this.matrix,o=this.rhsColumn,a=this.width-1,u=this.height-1,h,d=0;;){for(var c=0,g=-this.precision,p=1;p<=u;p++){h=this.unrestrictedVars[this.varIndexByRow[p]]===!0;var x=s[p][o];x<g&&(g=x,c=p)}if(c===0)return this.feasible=!0,d;for(var y=0,b=-1/0,V=s[0],w=s[c],z=1;z<=a;z++){var B=w[z];if(h=this.unrestrictedVars[this.varIndexByCol[z]]===!0,h||B<-this.precision){var k=-V[z]/B;b<k&&(b=k,y=z)}}if(y===0)return this.feasible=!1,d;if(r){i.push([this.varIndexByRow[c],this.varIndexByCol[y]]);var T=this.checkForCycles(i);if(T.length>0)return this.model.messages.push("Cycle in phase 1"),this.model.messages.push("Start :"+T[0]),this.model.messages.push("Length :"+T[1]),this.feasible=!1,d}this.pivot(c,y),d+=1}},Z.prototype.phase2=function(){for(var r=this.model.checkForCycles,i=[],s=this.matrix,o=this.rhsColumn,a=this.width-1,u=this.height-1,h=this.precision,d=this.optionalObjectives.length,c=null,g=0,p,x;;){var y=s[this.costRowIndex];d>0&&(c=[]);for(var b=0,V=h,w=!1,z=1;z<=a;z++){if(p=y[z],x=this.unrestrictedVars[this.varIndexByCol[z]]===!0,d>0&&-h<p&&p<h){c.push(z);continue}if(x&&p<0){-p>V&&(V=-p,b=z,w=!0);continue}p>V&&(V=p,b=z,w=!1)}if(d>0)for(var B=0;b===0&&c.length>0&&B<d;){var k=[],T=this.optionalObjectives[B].reducedCosts;V=h;for(var $=0;$<c.length;$++){if(z=c[$],p=T[z],x=this.unrestrictedVars[this.varIndexByCol[z]]===!0,-h<p&&p<h){k.push(z);continue}if(x&&p<0){-p>V&&(V=-p,b=z,w=!0);continue}p>V&&(V=p,b=z,w=!1)}c=k,B+=1}if(b===0)return this.setEvaluation(),this.simplexIters+=1,g;for(var A=0,D=1/0,tt=this.varIndexByRow,J=1;J<=u;J++){var j=s[J],X=j[o],ft=j[b];if(!(-h<ft&&ft<h)){if(ft>0&&h>X&&X>-h){D=0,A=J;break}var St=w?-X/ft:X/ft;St>h&&D>St&&(D=St,A=J)}}if(D===1/0)return this.evaluation=-1/0,this.bounded=!1,this.unboundedVarIndex=this.varIndexByCol[b],g;if(r){i.push([this.varIndexByRow[A],this.varIndexByCol[b]]);var $t=this.checkForCycles(i);if($t.length>0)return this.model.messages.push("Cycle in phase 2"),this.model.messages.push("Start :"+$t[0]),this.model.messages.push("Length :"+$t[1]),this.feasible=!1,g}this.pivot(A,b,!0),g+=1}};var xr=[];Z.prototype.pivot=function(r,i){var s=this.matrix,o=s[r][i],a=this.height-1,u=this.width-1,h=this.varIndexByRow[r],d=this.varIndexByCol[i];this.varIndexByRow[r]=d,this.varIndexByCol[i]=h,this.rowByVarIndex[d]=r,this.rowByVarIndex[h]=-1,this.colByVarIndex[d]=-1,this.colByVarIndex[h]=i;for(var c=s[r],g=0,p=0;p<=u;p++)c[p]>=-1e-16&&c[p]<=1e-16?c[p]=0:(c[p]/=o,xr[g]=p,g+=1);c[i]=1/o;for(var x,y,b,V=this.precision,w=0;w<=a;w++)if(w!==r){var z=s[w];if(x=z[i],x>=-1e-16&&x<=1e-16)x!==0&&(z[i]=0);else{for(y=0;y<g;y++)p=xr[y],b=c[p],b>=-1e-16&&b<=1e-16?b!==0&&(c[p]=0):z[p]=z[p]-x*b;z[i]=-x/o}}var B=this.optionalObjectives.length;if(B>0)for(var k=0;k<B;k+=1){var T=this.optionalObjectives[k].reducedCosts;if(x=T[i],x!==0){for(y=0;y<g;y++)p=xr[y],b=c[p],b!==0&&(T[p]=T[p]-x*b);T[i]=-x/o}}},Z.prototype.checkForCycles=function(r){for(var i=0;i<r.length-1;i++)for(var s=i+1;s<r.length;s++){var o=r[i],a=r[s];if(o[0]===a[0]&&o[1]===a[1]){if(s-i>r.length-s)break;for(var u=!0,h=1;h<s-i;h++){var d=r[i+h],c=r[s+h];if(d[0]!==c[0]||d[1]!==c[1]){u=!1;break}}if(u)return[i,s-i]}}return[]};function yr(r,i,s,o){this.id=r,this.cost=i,this.index=s,this.value=0,this.priority=o}function sn(r,i,s,o){yr.call(this,r,i,s,o)}sn.prototype.isInteger=!0;function _r(r,i){yr.call(this,r,0,i,0)}_r.prototype.isSlack=!0;function an(r,i){this.variable=r,this.coefficient=i}function on(r,i,s){return s===0||s==="required"?null:(i=i||1,s=s||1,r.isMinimization===!1&&(i=-i),r.addVariable(i,"r"+r.relaxationIndex++,!1,!1,s))}function Jt(r,i,s,o){this.slack=new _r("s"+s,s),this.index=s,this.model=o,this.rhs=r,this.isUpperBound=i,this.terms=[],this.termsByVarIndex={},this.relaxation=null}Jt.prototype.addTerm=function(r,i){var s=i.index,o=this.termsByVarIndex[s];if(o===void 0)o=new an(i,r),this.termsByVarIndex[s]=o,this.terms.push(o),this.isUpperBound===!0&&(r=-r),this.model.updateConstraintCoefficient(this,i,r);else{var a=o.coefficient+r;this.setVariableCoefficient(a,i)}return this},Jt.prototype.removeTerm=function(r){return this},Jt.prototype.setRightHandSide=function(r){if(r!==this.rhs){var i=r-this.rhs;this.isUpperBound===!0&&(i=-i),this.rhs=r,this.model.updateRightHandSide(this,i)}return this},Jt.prototype.setVariableCoefficient=function(r,i){var s=i.index;if(s===-1){console.warn("[Constraint.setVariableCoefficient] Trying to change coefficient of inexistant variable.");return}var o=this.termsByVarIndex[s];if(o===void 0)this.addTerm(r,i);else if(r!==o.coefficient){var a=r-o.coefficient;this.isUpperBound===!0&&(a=-a),o.coefficient=r,this.model.updateConstraintCoefficient(this,i,a)}return this},Jt.prototype.relax=function(r,i){this.relaxation=on(this.model,r,i),this._relax(this.relaxation)},Jt.prototype._relax=function(r){r!==null&&(this.isUpperBound?this.setVariableCoefficient(-1,r):this.setVariableCoefficient(1,r))};function ie(r,i){this.upperBound=r,this.lowerBound=i,this.model=r.model,this.rhs=r.rhs,this.relaxation=null}ie.prototype.isEquality=!0,ie.prototype.addTerm=function(r,i){return this.upperBound.addTerm(r,i),this.lowerBound.addTerm(r,i),this},ie.prototype.removeTerm=function(r){return this.upperBound.removeTerm(r),this.lowerBound.removeTerm(r),this},ie.prototype.setRightHandSide=function(r){this.upperBound.setRightHandSide(r),this.lowerBound.setRightHandSide(r),this.rhs=r},ie.prototype.relax=function(r,i){this.relaxation=on(this.model,r,i),this.upperBound.relaxation=this.relaxation,this.upperBound._relax(this.relaxation),this.lowerBound.relaxation=this.relaxation,this.lowerBound._relax(this.relaxation)};var Dt={Constraint:Jt,Variable:yr,IntegerVariable:sn,SlackVariable:_r,Equality:ie,Term:an},br=Dt.SlackVariable;Z.prototype.addCutConstraints=function(r){for(var i=r.length,s=this.height,o=s+i,a=s;a<o;a+=1)this.matrix[a]===void 0&&(this.matrix[a]=this.matrix[a-1].slice());this.height=o,this.nVars=this.width+this.height-2;for(var u,h=this.width-1,d=0;d<i;d+=1){var c=r[d],g=s+d,p=c.type==="min"?-1:1,x=c.varIndex,y=this.rowByVarIndex[x],b=this.matrix[g];if(y===-1){for(b[this.rhsColumn]=p*c.value,u=1;u<=h;u+=1)b[u]=0;b[this.colByVarIndex[x]]=p}else{var V=this.matrix[y],w=V[this.rhsColumn];for(b[this.rhsColumn]=p*(c.value-w),u=1;u<=h;u+=1)b[u]=-p*V[u]}var z=this.getNewElementIndex();this.varIndexByRow[g]=z,this.rowByVarIndex[z]=g,this.colByVarIndex[z]=-1,this.variablesPerIndex[z]=new br("s"+z,z),this.nVars+=1}},Z.prototype._addLowerBoundMIRCut=function(r){if(r===this.costRowIndex)return!1;var i=this.model,s=this.matrix,o=this.variablesPerIndex[this.varIndexByRow[r]];if(!o.isInteger)return!1;var a=s[r][this.rhsColumn],u=a-Math.floor(a);if(u<this.precision||1-this.precision<u)return!1;var h=this.height;s[h]=s[h-1].slice(),this.height+=1,this.nVars+=1;var d=this.getNewElementIndex();this.varIndexByRow[h]=d,this.rowByVarIndex[d]=h,this.colByVarIndex[d]=-1,this.variablesPerIndex[d]=new br("s"+d,d),s[h][this.rhsColumn]=Math.floor(a);for(var c=1;c<this.varIndexByCol.length;c+=1){var g=this.variablesPerIndex[this.varIndexByCol[c]];if(!g.isInteger)s[h][c]=Math.min(0,s[r][c]/(1-u));else{var p=s[r][c],x=Math.floor(p)+Math.max(0,p-Math.floor(p)-u)/(1-u);s[h][c]=x}}for(var y=0;y<this.width;y+=1)s[h][y]-=s[r][y];return!0},Z.prototype._addUpperBoundMIRCut=function(r){if(r===this.costRowIndex)return!1;var i=this.model,s=this.matrix,o=this.variablesPerIndex[this.varIndexByRow[r]];if(!o.isInteger)return!1;var a=s[r][this.rhsColumn],u=a-Math.floor(a);if(u<this.precision||1-this.precision<u)return!1;var h=this.height;s[h]=s[h-1].slice(),this.height+=1,this.nVars+=1;var d=this.getNewElementIndex();this.varIndexByRow[h]=d,this.rowByVarIndex[d]=h,this.colByVarIndex[d]=-1,this.variablesPerIndex[d]=new br("s"+d,d),s[h][this.rhsColumn]=-u;for(var c=1;c<this.varIndexByCol.length;c+=1){var g=this.variablesPerIndex[this.varIndexByCol[c]],p=s[r][c],x=p-Math.floor(p);g.isInteger?x<=u?s[h][c]=-x:s[h][c]=-(1-x)*u/x:p>=0?s[h][c]=-p:s[h][c]=p*u/(1-u)}return!0},Z.prototype.applyMIRCuts=function(){},Z.prototype._putInBase=function(r){var i=this.rowByVarIndex[r];if(i===-1){for(var s=this.colByVarIndex[r],o=1;o<this.height;o+=1){var a=this.matrix[o][s];if(a<-this.precision||this.precision<a){i=o;break}}this.pivot(i,s)}return i},Z.prototype._takeOutOfBase=function(r){var i=this.colByVarIndex[r];if(i===-1){for(var s=this.rowByVarIndex[r],o=this.matrix[s],a=1;a<this.height;a+=1){var u=o[a];if(u<-this.precision||this.precision<u){i=a;break}}this.pivot(s,i)}return i},Z.prototype.updateVariableValues=function(){for(var r=this.variables.length,i=Math.round(1/this.precision),s=0;s<r;s+=1){var o=this.variables[s],a=o.index,u=this.rowByVarIndex[a];if(u===-1)o.value=0;else{var h=this.matrix[u][this.rhsColumn];o.value=Math.round((h+Number.EPSILON)*i)/i}}},Z.prototype.updateRightHandSide=function(r,i){var s=this.height-1,o=this.rowByVarIndex[r.index];if(o===-1){for(var a=this.colByVarIndex[r.index],u=0;u<=s;u+=1){var h=this.matrix[u];h[this.rhsColumn]-=i*h[a]}var d=this.optionalObjectives.length;if(d>0)for(var c=0;c<d;c+=1){var g=this.optionalObjectives[c].reducedCosts;g[this.rhsColumn]-=i*g[a]}}else this.matrix[o][this.rhsColumn]-=i},Z.prototype.updateConstraintCoefficient=function(r,i,s){if(r.index===i.index)throw new Error("[Tableau.updateConstraintCoefficient] constraint index should not be equal to variable index !");var o=this._putInBase(r.index),a=this.colByVarIndex[i.index];if(a===-1)for(var u=this.rowByVarIndex[i.index],h=0;h<this.width;h+=1)this.matrix[o][h]+=s*this.matrix[u][h];else this.matrix[o][a]-=s},Z.prototype.updateCost=function(r,i){var s=r.index,o=this.width-1,a=this.colByVarIndex[s];if(a===-1){var u=this.matrix[this.rowByVarIndex[s]],h;if(r.priority===0){var d=this.matrix[0];for(h=0;h<=o;h+=1)d[h]+=i*u[h]}else{var c=this.objectivesByPriority[r.priority].reducedCosts;for(h=0;h<=o;h+=1)c[h]+=i*u[h]}}else this.matrix[0][a]-=i},Z.prototype.addConstraint=function(r){var i=r.isUpperBound?1:-1,s=this.height,o=this.matrix[s];o===void 0&&(o=this.matrix[0].slice(),this.matrix[s]=o);for(var a=this.width-1,u=0;u<=a;u+=1)o[u]=0;o[this.rhsColumn]=i*r.rhs;for(var h=r.terms,d=h.length,c=0;c<d;c+=1){var g=h[c],p=g.coefficient,x=g.variable.index,y=this.rowByVarIndex[x];if(y===-1)o[this.colByVarIndex[x]]+=i*p;else{var b=this.matrix[y],V=b[this.rhsColumn];for(u=0;u<=a;u+=1)o[u]-=i*p*b[u]}}var w=r.index;this.varIndexByRow[s]=w,this.rowByVarIndex[w]=s,this.colByVarIndex[w]=-1,this.height+=1},Z.prototype.removeConstraint=function(r){var i=r.index,s=this.height-1,o=this._putInBase(i),a=this.matrix[s];this.matrix[s]=this.matrix[o],this.matrix[o]=a,this.varIndexByRow[o]=this.varIndexByRow[s],this.varIndexByRow[s]=-1,this.rowByVarIndex[i]=-1,this.availableIndexes[this.availableIndexes.length]=i,r.slack.index=-1,this.height-=1},Z.prototype.addVariable=function(r){var i=this.height-1,s=this.width,o=this.model.isMinimization===!0?-r.cost:r.cost,a=r.priority,u=this.optionalObjectives.length;if(u>0)for(var h=0;h<u;h+=1)this.optionalObjectives[h].reducedCosts[s]=0;a===0?this.matrix[0][s]=o:(this.setOptionalObjective(a,s,o),this.matrix[0][s]=0);for(var d=1;d<=i;d+=1)this.matrix[d][s]=0;var c=r.index;this.varIndexByCol[s]=c,this.rowByVarIndex[c]=-1,this.colByVarIndex[c]=s,this.width+=1},Z.prototype.removeVariable=function(r){var i=r.index,s=this._takeOutOfBase(i),o=this.width-1;if(s!==o){for(var a=this.height-1,u=0;u<=a;u+=1){var h=this.matrix[u];h[s]=h[o]}var d=this.optionalObjectives.length;if(d>0)for(var c=0;c<d;c+=1){var g=this.optionalObjectives[c].reducedCosts;g[s]=g[o]}var p=this.varIndexByCol[o];this.varIndexByCol[s]=p,this.colByVarIndex[p]=s}this.varIndexByCol[o]=-1,this.colByVarIndex[i]=-1,this.availableIndexes[this.availableIndexes.length]=i,r.index=-1,this.width-=1},Z.prototype.log=function(r,i){console.log("****",r,"****"),console.log("Nb Variables",this.width-1),console.log("Nb Constraints",this.height-1),console.log("Basic Indexes",this.varIndexByRow),console.log("Non Basic Indexes",this.varIndexByCol),console.log("Rows",this.rowByVarIndex),console.log("Cols",this.colByVarIndex);var s=5,o="",a=[" "],u,h,d,c,g,p,x,y,b,V,w;for(h=1;h<this.width;h+=1)g=this.varIndexByCol[h],c=this.variablesPerIndex[g],c===void 0?p="c"+g:p=c.id,x=p.length,y=" ",b="	",x>5?y+=" ":b+="	",a[h]=y,o+=b+p;console.log(o);var z,B=this.matrix[this.costRowIndex],k="	";for(u=1;u<this.width;u+=1)z="	",k+=z,k+=a[u],k+=B[u].toFixed(s);for(z="	",k+=z+a[0]+B[0].toFixed(s),console.log(k+"	Z"),d=1;d<this.height;d+=1){for(V=this.matrix[d],w="	",h=1;h<this.width;h+=1)z="	",w+=z+a[h]+V[h].toFixed(s);z="	",w+=z+a[0]+V[0].toFixed(s),g=this.varIndexByRow[d],c=this.variablesPerIndex[g],c===void 0?p="c"+g:p=c.id,console.log(w+"	"+p)}console.log("");var T=this.optionalObjectives.length;if(T>0){console.log("    Optional objectives:");for(var $=0;$<T;$+=1){var A=this.optionalObjectives[$].reducedCosts,D="";for(u=1;u<this.width;u+=1)z=A[u]<0?"":" ",D+=z,D+=a[u],D+=A[u].toFixed(s);z=A[0]<0?"":" ",D+=z+a[0]+A[0].toFixed(s),console.log(D+" z"+$)}}return console.log("Feasible?",this.feasible),console.log("evaluation",this.evaluation),this},Z.prototype.copy=function(){var r=new Z(this.precision);r.width=this.width,r.height=this.height,r.nVars=this.nVars,r.model=this.model,r.variables=this.variables,r.variablesPerIndex=this.variablesPerIndex,r.unrestrictedVars=this.unrestrictedVars,r.lastElementIndex=this.lastElementIndex,r.varIndexByRow=this.varIndexByRow.slice(),r.varIndexByCol=this.varIndexByCol.slice(),r.rowByVarIndex=this.rowByVarIndex.slice(),r.colByVarIndex=this.colByVarIndex.slice(),r.availableIndexes=this.availableIndexes.slice();for(var i=[],s=0;s<this.optionalObjectives.length;s++)i[s]=this.optionalObjectives[s].copy();r.optionalObjectives=i;for(var o=this.matrix,a=new Array(this.height),u=0;u<this.height;u++)a[u]=o[u].slice();return r.matrix=a,r},Z.prototype.save=function(){this.savedState=this.copy()},Z.prototype.restore=function(){if(this.savedState!==null){var r=this.savedState,i=r.matrix;this.nVars=r.nVars,this.model=r.model,this.variables=r.variables,this.variablesPerIndex=r.variablesPerIndex,this.unrestrictedVars=r.unrestrictedVars,this.lastElementIndex=r.lastElementIndex,this.width=r.width,this.height=r.height;var s,o;for(s=0;s<this.height;s+=1){var a=i[s],u=this.matrix[s];for(o=0;o<this.width;o+=1)u[o]=a[o]}var h=r.varIndexByRow;for(o=0;o<this.height;o+=1)this.varIndexByRow[o]=h[o];for(;this.varIndexByRow.length>this.height;)this.varIndexByRow.pop();var d=r.varIndexByCol;for(s=0;s<this.width;s+=1)this.varIndexByCol[s]=d[s];for(;this.varIndexByCol.length>this.width;)this.varIndexByCol.pop();for(var c=r.rowByVarIndex,g=r.colByVarIndex,p=0;p<this.nVars;p+=1)this.rowByVarIndex[p]=c[p],this.colByVarIndex[p]=g[p];if(r.optionalObjectives.length>0&&this.optionalObjectives.length>0){this.optionalObjectives=[],this.optionalObjectivePerPriority={};for(var x=0;x<r.optionalObjectives.length;x++){var y=r.optionalObjectives[x].copy();this.optionalObjectives[x]=y,this.optionalObjectivePerPriority[y.priority]=y}}}};function un(r,i){this.index=r,this.value=i}Z.prototype.getMostFractionalVar=function(){for(var r=0,i=null,s=null,o=this.model.integerVariables,a=o.length,u=0;u<a;u++){var h=o[u].index,d=this.rowByVarIndex[h];if(d!==-1){var c=this.matrix[d][this.rhsColumn],g=Math.abs(c-Math.round(c));r<g&&(r=g,i=h,s=c)}}return new un(i,s)},Z.prototype.getFractionalVarWithLowestCost=function(){for(var r=1/0,i=null,s=null,o=this.model.integerVariables,a=o.length,u=0;u<a;u++){var h=o[u],d=h.index,c=this.rowByVarIndex[d];if(c!==-1){var g=this.matrix[c][this.rhsColumn];if(Math.abs(g-Math.round(g))>this.precision){var p=h.cost;r>p&&(r=p,i=d,s=g)}}}return new un(i,s)},Z.prototype.countIntegerValues=function(){for(var r=0,i=1;i<this.height;i+=1)if(this.variablesPerIndex[this.varIndexByRow[i]].isInteger){var s=this.matrix[i][this.rhsColumn];s=s-Math.floor(s),s<this.precision&&-s<this.precision&&(r+=1)}return r},Z.prototype.isIntegral=function(){for(var r=this.model.integerVariables,i=r.length,s=0;s<i;s++){var o=this.rowByVarIndex[r[s].index];if(o!==-1){var a=this.matrix[o][this.rhsColumn];if(Math.abs(a-Math.round(a))>this.precision)return!1}}return!0},Z.prototype.computeFractionalVolume=function(r){for(var i=-1,s=1;s<this.height;s+=1)if(this.variablesPerIndex[this.varIndexByRow[s]].isInteger){var o=this.matrix[s][this.rhsColumn];o=Math.abs(o);var a=Math.min(o-Math.floor(o),Math.floor(o+1));if(a<this.precision){if(!r)return 0}else i===-1?i=o:i*=o}return i===-1?0:i};var Rs=Z;function ln(r,i,s){this.type=r,this.varIndex=i,this.value=s}function wr(r,i){this.relaxedEvaluation=r,this.cuts=i}function Ds(r,i){return i.relaxedEvaluation-r.relaxedEvaluation}Z.prototype.applyCuts=function(r){if(this.restore(),this.addCutConstraints(r),this.simplex(),this.model.useMIRCuts)for(var i=!0;i;){var s=this.computeFractionalVolume(!0);this.applyMIRCuts(),this.simplex();var o=this.computeFractionalVolume(!0);o>=.9*s&&(i=!1)}},Z.prototype.branchAndCut=function(){var r=[],i=0,s=this.model.tolerance,o=!0,a=1e99;this.model.timeout&&(a=Date.now()+this.model.timeout);for(var u=1/0,h=null,d=[],c=0;c<this.optionalObjectives.length;c+=1)d.push(1/0);var g=new wr(-1/0,[]),p;for(r.push(g);r.length>0&&o===!0&&Date.now()<a;)if(this.model.isMinimization?p=this.bestPossibleEval*(1+s):p=this.bestPossibleEval*(1-s),s>0&&u<p&&(o=!1),g=r.pop(),!(g.relaxedEvaluation>u)){var x=g.cuts;if(this.applyCuts(x),i++,this.feasible!==!1){var y=this.evaluation;if(!(y>u)){if(y===u){for(var b=!0,V=0;V<this.optionalObjectives.length&&!(this.optionalObjectives[V].reducedCosts[0]>d[V]);V+=1)if(this.optionalObjectives[V].reducedCosts[0]<d[V]){b=!1;break}if(b)continue}if(this.isIntegral()===!0){if(this.__isIntegral=!0,i===1){this.branchAndCutIterations=i;return}h=g,u=y;for(var w=0;w<this.optionalObjectives.length;w+=1)d[w]=this.optionalObjectives[w].reducedCosts[0]}else{i===1&&this.save();for(var z=this.getMostFractionalVar(),B=z.index,k=[],T=[],$=x.length,A=0;A<$;A+=1){var D=x[A];D.varIndex===B?D.type==="min"?T.push(D):k.push(D):(k.push(D),T.push(D))}var tt=Math.ceil(z.value),J=Math.floor(z.value),j=new ln("min",B,tt);k.push(j);var X=new ln("max",B,J);T.push(X),r.push(new wr(y,k)),r.push(new wr(y,T)),r.sort(Ds)}}}}h!==null&&this.applyCuts(h.cuts),this.branchAndCutIterations=i};var Ls={},Te=Dt.Constraint,hn=Dt.Equality,Ps=Dt.Variable,qs=Dt.IntegerVariable;function et(r,i){this.tableau=new Z(r),this.name=i,this.variables=[],this.integerVariables=[],this.unrestrictedVariables={},this.constraints=[],this.nConstraints=0,this.nVariables=0,this.isMinimization=!0,this.tableauInitialized=!1,this.relaxationIndex=1,this.useMIRCuts=!1,this.checkForCycles=!0,this.messages=[]}var Er=et;et.prototype.minimize=function(){return this.isMinimization=!0,this},et.prototype.maximize=function(){return this.isMinimization=!1,this},et.prototype._getNewElementIndex=function(){if(this.availableIndexes.length>0)return this.availableIndexes.pop();var r=this.lastElementIndex;return this.lastElementIndex+=1,r},et.prototype._addConstraint=function(r){var i=r.slack;this.tableau.variablesPerIndex[i.index]=i,this.constraints.push(r),this.nConstraints+=1,this.tableauInitialized===!0&&this.tableau.addConstraint(r)},et.prototype.smallerThan=function(r){var i=new Te(r,!0,this.tableau.getNewElementIndex(),this);return this._addConstraint(i),i},et.prototype.greaterThan=function(r){var i=new Te(r,!1,this.tableau.getNewElementIndex(),this);return this._addConstraint(i),i},et.prototype.equal=function(r){var i=new Te(r,!0,this.tableau.getNewElementIndex(),this);this._addConstraint(i);var s=new Te(r,!1,this.tableau.getNewElementIndex(),this);return this._addConstraint(s),new hn(i,s)},et.prototype.addVariable=function(r,i,s,o,a){if(typeof a=="string")switch(a){case"required":a=0;break;case"strong":a=1;break;case"medium":a=2;break;case"weak":a=3;break;default:a=0;break}var u=this.tableau.getNewElementIndex();i==null&&(i="v"+u),r==null&&(r=0),a==null&&(a=0);var h;return s?(h=new qs(i,r,u,a),this.integerVariables.push(h)):h=new Ps(i,r,u,a),this.variables.push(h),this.tableau.variablesPerIndex[u]=h,o&&(this.unrestrictedVariables[u]=!0),this.nVariables+=1,this.tableauInitialized===!0&&this.tableau.addVariable(h),h},et.prototype._removeConstraint=function(r){var i=this.constraints.indexOf(r);if(i===-1){console.warn("[Model.removeConstraint] Constraint not present in model");return}this.constraints.splice(i,1),this.nConstraints-=1,this.tableauInitialized===!0&&this.tableau.removeConstraint(r),r.relaxation&&this.removeVariable(r.relaxation)},et.prototype.removeConstraint=function(r){return r.isEquality?(this._removeConstraint(r.upperBound),this._removeConstraint(r.lowerBound)):this._removeConstraint(r),this},et.prototype.removeVariable=function(r){var i=this.variables.indexOf(r);if(i===-1){console.warn("[Model.removeVariable] Variable not present in model");return}return this.variables.splice(i,1),this.tableauInitialized===!0&&this.tableau.removeVariable(r),this},et.prototype.updateRightHandSide=function(r,i){return this.tableauInitialized===!0&&this.tableau.updateRightHandSide(r,i),this},et.prototype.updateConstraintCoefficient=function(r,i,s){return this.tableauInitialized===!0&&this.tableau.updateConstraintCoefficient(r,i,s),this},et.prototype.setCost=function(r,i){var s=r-i.cost;return this.isMinimization===!1&&(s=-s),i.cost=r,this.tableau.updateCost(i,s),this},et.prototype.loadJson=function(r){this.isMinimization=r.opType!=="max";for(var i=r.variables,s=r.constraints,o={},a={},u=Object.keys(s),h=u.length,d=0;d<h;d+=1){var c=u[d],g=s[c],p=g.equal,x=g.weight,y=g.priority,b=x!==void 0||y!==void 0,V,w;if(p===void 0){var z=g.min;z!==void 0&&(V=this.greaterThan(z),o[c]=V,b&&V.relax(x,y));var B=g.max;B!==void 0&&(w=this.smallerThan(B),a[c]=w,b&&w.relax(x,y))}else{V=this.greaterThan(p),o[c]=V,w=this.smallerThan(p),a[c]=w;var k=new hn(V,w);b&&k.relax(x,y)}}var T=Object.keys(i),$=T.length;this.tolerance=r.tolerance||0,r.timeout&&(this.timeout=r.timeout),r.options&&(r.options.timeout&&(this.timeout=r.options.timeout),this.tolerance===0&&(this.tolerance=r.options.tolerance||0),r.options.useMIRCuts&&(this.useMIRCuts=r.options.useMIRCuts),typeof r.options.exitOnCycles>"u"?this.checkForCycles=!0:this.checkForCycles=r.options.exitOnCycles);for(var A=r.ints||{},D=r.binaries||{},tt=r.unrestricted||{},J=r.optimize,j=0;j<$;j+=1){var X=T[j],ft=i[X],St=ft[J]||0,$t=!!D[X],kt=!!A[X]||$t,Yt=!!tt[X],nt=this.addVariable(St,X,kt,Yt);$t&&this.smallerThan(1).addTerm(1,nt);var de=Object.keys(ft);for(d=0;d<de.length;d+=1){var Vt=de[d];if(Vt!==J){var zt=ft[Vt],at=o[Vt];at!==void 0&&at.addTerm(zt,nt);var Qt=a[Vt];Qt!==void 0&&Qt.addTerm(zt,nt)}}}return this},et.prototype.getNumberOfIntegerVariables=function(){return this.integerVariables.length},et.prototype.solve=function(){return this.tableauInitialized===!1&&(this.tableau.setModel(this),this.tableauInitialized=!0),this.tableau.solve()},et.prototype.isFeasible=function(){return this.tableau.feasible},et.prototype.save=function(){return this.tableau.save()},et.prototype.restore=function(){return this.tableau.restore()},et.prototype.activateMIRCuts=function(r){this.useMIRCuts=r},et.prototype.debug=function(r){this.checkForCycles=r},et.prototype.log=function(r){return this.tableau.log(r)};var Fs=function(r){var i,s,o;if(typeof r.optimize=="string")if(r.constraints[r.optimize]){i=Math.random();for(s in r.variables)r.variables[s][r.optimize]&&(r.variables[s][i]=r.variables[s][r.optimize]);return r.constraints[i]=r.constraints[r.optimize],delete r.constraints[r.optimize],r}else return r;else{for(o in r.optimize)if(r.constraints[o])if(r.constraints[o]==="equal")delete r.optimize[o];else{i=Math.random();for(s in r.variables)r.variables[s][o]&&(r.variables[s][i]=r.variables[s][o]);r.constraints[i]=r.constraints[o],delete r.constraints[o]}return r}},fn={CleanObjectiveAttributes:Fs};function Hs(r){var i={is_blank:/^\W{0,}$/,is_objective:/(max|min)(imize){0,}\:/i,is_int:/^(?!\/\*)\W{0,}int/i,is_bin:/^(?!\/\*)\W{0,}bin/i,is_constraint:/(\>|\<){0,}\=/i,is_unrestricted:/^\S{0,}unrestricted/i,parse_lhs:/(\-|\+){0,1}\s{0,1}\d{0,}\.{0,}\d{0,}\s{0,}[A-Za-z]\S{0,}/gi,parse_rhs:/(\-|\+){0,1}\d{1,}\.{0,}\d{0,}\W{0,}\;{0,1}$/i,parse_dir:/(\>|\<){0,}\=/gi,parse_int:/[^\s|^\,]+/gi,parse_bin:/[^\s|^\,]+/gi,get_num:/(\-|\+){0,1}(\W|^)\d+\.{0,1}\d{0,}/g,get_word:/[A-Za-z].*/},s={opType:"",optimize:"_obj",constraints:{},variables:{}},o={">=":"min","<=":"max","=":"equal"},a="",u=null,h="",d="",c="",g=0;typeof r=="string"&&(r=r.split(`
`));for(var p=0;p<r.length;p++)if(c="__"+p,a=r[p],u=null,i.is_objective.test(a))s.opType=a.match(/(max|min)/gi)[0],u=a.match(i.parse_lhs).map(function(b){return b.replace(/\s+/,"")}).slice(1),u.forEach(function(b){h=b.match(i.get_num),h===null?b.substr(0,1)==="-"?h=-1:h=1:h=h[0],h=parseFloat(h),d=b.match(i.get_word)[0].replace(/\;$/,""),s.variables[d]=s.variables[d]||{},s.variables[d]._obj=h});else if(i.is_int.test(a))u=a.match(i.parse_int).slice(1),s.ints=s.ints||{},u.forEach(function(b){b=b.replace(";",""),s.ints[b]=1});else if(i.is_bin.test(a))u=a.match(i.parse_bin).slice(1),s.binaries=s.binaries||{},u.forEach(function(b){b=b.replace(";",""),s.binaries[b]=1});else if(i.is_constraint.test(a)){var x=a.indexOf(":"),y=x===-1?a:a.slice(x+1);u=y.match(i.parse_lhs).map(function(b){return b.replace(/\s+/,"")}),u.forEach(function(b){h=b.match(i.get_num),h===null?b.substr(0,1)==="-"?h=-1:h=1:h=h[0],h=parseFloat(h),d=b.match(i.get_word)[0],s.variables[d]=s.variables[d]||{},s.variables[d][c]=h}),g=parseFloat(a.match(i.parse_rhs)[0]),a=o[a.match(i.parse_dir)[0]],s.constraints[c]=s.constraints[c]||{},s.constraints[c][a]=g}else i.is_unrestricted.test(a)&&(u=a.match(i.parse_int).slice(1),s.unrestricted=s.unrestricted||{},u.forEach(function(b){b=b.replace(";",""),s.unrestricted[b]=1}));return s}function js(r){if(!r)throw new Error("Solver requires a model to operate on");var i="",s={max:"<=",min:">=",equal:"="},o=new RegExp("[^A-Za-z0-9]+","gi");i+=r.opType+":";for(var a in r.variables)r.variables[a][a]=r.variables[a][a]?r.variables[a][a]:1,r.variables[a][r.optimize]&&(i+=" "+r.variables[a][r.optimize]+" "+a.replace(o,"_"));i+=`;
`;for(a in r.constraints)for(var u in r.constraints[a]){for(var h in r.variables)r.variables[h][a]&&(i+=" "+r.variables[h][a]+" "+h.replace(o,"_"));i+=" "+s[u]+" "+r.constraints[a][u],i+=`;
`}if(r.ints){i+=`

`;for(a in r.ints)i+="int "+a.replace(o,"_")+`;
`}if(r.unrestricted){i+=`

`;for(a in r.unrestricted)i+="unrestricted "+a.replace(o,"_")+`;
`}return i}var Xs=function(r){return r.length?Hs(r):js(r)},Ys=function(r,i){var s=i.optimize,o=JSON.parse(JSON.stringify(i.optimize)),a=Object.keys(i.optimize),u,h=0,d={},c="",g={},p=[],x,y,b,V;for(delete i.optimize,x=0;x<a.length;x++)o[a[x]]=0;for(x=0;x<a.length;x++){i.optimize=a[x],i.opType=s[a[x]],u=r.Solve(i,void 0,void 0,!0);for(V in a)if(!i.variables[a[V]]){u[a[V]]=u[a[V]]?u[a[V]]:0;for(b in i.variables)i.variables[b][a[V]]&&u[b]&&(u[a[V]]+=u[b]*i.variables[b][a[V]])}for(c="base",y=0;y<a.length;y++)u[a[y]]?c+="-"+(u[a[y]]*1e3|0)/1e3:c+="-0";if(!d[c]){for(d[c]=1,h++,y=0;y<a.length;y++)u[a[y]]&&(o[a[y]]+=u[a[y]]);delete u.feasible,delete u.result,p.push(u)}}for(x=0;x<a.length;x++)i.constraints[a[x]]={equal:o[a[x]]/h};i.optimize="cheater-"+Math.random(),i.opType="max";for(x in i.variables)i.variables[x].cheater=1;for(x in p)for(b in p[x])g[b]=g[b]||{min:1e99,max:-1e99};for(x in g)for(b in p)p[b][x]?(p[b][x]>g[x].max&&(g[x].max=p[b][x]),p[b][x]<g[x].min&&(g[x].min=p[b][x])):(p[b][x]=0,g[x].min=0);return u=r.Solve(i,void 0,void 0,!0),{midpoint:u,vertices:p,ranges:g}},Gs=Dt.Constraint,Us=Dt.Variable,Ws=Dt.Numeral,Ks=Dt.Term,cn=function(){this.Model=Er,this.branchAndCut=Ls,this.Constraint=Gs,this.Variable=Us,this.Numeral=Ws,this.Term=Ks,this.Tableau=Rs,this.lastSolvedModel=null,this.Solve=function(r,i,s,o){if(o)for(var a in fn)r=fn[a](r);if(!r)throw new Error("Solver requires a model to operate on");r instanceof Er||(r=new Er(i).loadJson(r));var u=r.solve();if(this.lastSolvedModel=r,u.solutionSet=u.generateSolutionSet(),s)return u;var h={};return h.feasible=u.feasible,h.result=u.evaluation,h.bounded=u.bounded,u._tableau.__isIntegral&&(h.isIntegral=!0),Object.keys(u.solutionSet).forEach(function(d){u.solutionSet[d]!==0&&(h[d]=u.solutionSet[d])}),h},this.ReformatLP=Xs,this.MultiObjective=function(r){return Ys(this,r)}};typeof window=="object"&&(window.solver=new cn);var Ir=new cn;let dn="crossings";function Zs(){let r=!1;function i(...u){return u.map(h=>h.id).sort().join(r?" => ":"\0\0")}function s(u,h){h.sort((d,c)=>d.id>c.id||-1),h.slice(0,h.length-1).forEach((d,c)=>h.slice(c+1).forEach(g=>{let p=i(d,g);u.ints[p]=1,u.constraints[p]={max:1},u.variables[p]={[p]:1}})),h.slice(0,h.length-1).forEach((d,c)=>h.slice(c+1).forEach((g,p)=>{let x=i(d,g);h.slice(c+p+2).forEach(y=>{let b=i(d,y),V=i(g,y),w=i(d,g,y),z=w+"+";u.constraints[z]={max:1},u.variables[x][z]=1,u.variables[b][z]=-1,u.variables[V][z]=1;let B=w+"-";u.constraints[B]={min:0},u.variables[x][B]=1,u.variables[b][B]=-1,u.variables[V][B]=1})}))}function o(u,h){h.slice(0,h.length-1).forEach((d,c)=>h.slice(c+1).forEach(g=>{let p=i(d,g);d.children.forEach(x=>g.children.filter(y=>y!==x).forEach(y=>{let b=i(x,y),V=r?`slack (${p}) (${b})`:`${p}\0\0\0${b}`,w=`${V}${r?" ":"\0\0\0"}+`,z=`${V}${r?" ":"\0\0\0"}-`;u.variables[V]={[w]:1,[z]:1,[dn]:1};let B=+(x.id>y.id),k=B||-1;u.constraints[w]={min:B},u.variables[p][w]=1,u.variables[b][w]=k,u.constraints[z]={min:-B},u.variables[p][z]=-1,u.variables[b][z]=-k}))}))}function a(u){let h={optimize:dn,optType:"min",constraints:{},variables:{},ints:{}};u.forEach(c=>s(h,c)),u.slice(0,u.length-1).forEach(c=>o(h,c));let d=Ir.Solve(h);return u.forEach(c=>c.sort((g,p)=>(g.id>p.id||-1)*(d[i(g,p)]||-1))),u}return a.debug=function(u){return arguments.length?(r=u,a):r},a}function Cr(r,i){return r<i?-1:r>i?1:r>=i?0:NaN}function Js(r){return r.length===1&&(r=Qs(r)),{left:function(i,s,o,a){for(o==null&&(o=0),a==null&&(a=i.length);o<a;){var u=o+a>>>1;r(i[u],s)<0?o=u+1:a=u}return o},right:function(i,s,o,a){for(o==null&&(o=0),a==null&&(a=i.length);o<a;){var u=o+a>>>1;r(i[u],s)>0?a=u:o=u+1}return o}}}function Qs(r){return function(i,s){return Cr(r(i),s)}}var Xu=Js(Cr);function Mr(r){return r===null?NaN:+r}function ta(r,i,s){if(s==null&&(s=Mr),!!(o=r.length)){if((i=+i)<=0||o<2)return+s(r[0],0,r);if(i>=1)return+s(r[o-1],o-1,r);var o,a=(o-1)*i,u=Math.floor(a),h=+s(r[u],u,r),d=+s(r[u+1],u+1,r);return h+(d-h)*(a-u)}}function ea(r,i){var s=r.length,o=-1,a,u=[];if(i==null)for(;++o<s;)isNaN(a=Mr(r[o]))||u.push(a);else for(;++o<s;)isNaN(a=Mr(i(r[o],o,r)))||u.push(a);return ta(u.sort(Cr),.5)}function pn(){function r(i,s){s.forEach(o=>o._median=[]),i.forEach((o,a)=>o.children.forEach(u=>u._median.push(a))),s.forEach(o=>o._median=ea(o._median)||0),s.sort((o,a)=>o._median-a._median),s.forEach(o=>delete o._median)}return r}function Br(){let r=pn();function i(s){return s.slice(0,s.length-1).forEach((o,a)=>r(o,s[a+1])),s}return i.order=function(s){return arguments.length?(r=s,i):r},i}function ra(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function na(r,i){return i={exports:{}},r(i,i.exports),i.exports}var ia=na(function(r){var i=function(a,u){return a<u};function s(a){if(!(this instanceof s))return new s(a);this.array=[],this.size=0,this.compare=a||i}s.prototype.clone=function(){var a=new s(this.compare);a.size=this.size;for(var u=0;u<this.size;u++)a.array.push(this.array[u]);return a},s.prototype.add=function(a){var u=this.size;this.array[this.size]=a,this.size+=1;for(var h,d;u>0&&(h=u-1>>1,d=this.array[h],!!this.compare(a,d));)this.array[u]=d,u=h;this.array[u]=a},s.prototype.heapify=function(a){this.array=a,this.size=a.length;var u;for(u=this.size>>1;u>=0;u--)this._percolateDown(u)},s.prototype._percolateUp=function(a,u){for(var h=this.array[a],d,c;a>0&&(d=a-1>>1,c=this.array[d],!(!u&&!this.compare(h,c)));)this.array[a]=c,a=d;this.array[a]=h},s.prototype._percolateDown=function(a){for(var u=this.size,h=this.size>>>1,d=this.array[a],c,g,p;a<h&&(c=(a<<1)+1,g=c+1,p=this.array[c],g<u&&this.compare(this.array[g],p)&&(c=g,p=this.array[g]),!!this.compare(p,d));)this.array[a]=p,a=c;this.array[a]=d},s.prototype._removeAt=function(a){return this.isEmpty()||a>this.size-1||a<0?!1:(this._percolateUp(a,!0),this.poll(),!0)},s.prototype.remove=function(a,u){if(u||(u=this.compare),this.isEmpty())return!1;for(var h=0;h<this.size;h++)if(!(u(this.array[h],a)||u(a,this.array[h])))return this._removeAt(h);return!1},s.prototype.peek=function(){if(this.size!=0)return this.array[0]},s.prototype.poll=function(){if(this.size!=0){var a=this.array[0];return this.size>1?(this.array[0]=this.array[--this.size],this._percolateDown(0)):this.size-=1,a}},s.prototype.replaceTop=function(a){if(this.size!=0){var u=this.array[0];return this.array[0]=a,this._percolateDown(0),u}},s.prototype.trim=function(){this.array=this.array.slice(0,this.size)},s.prototype.isEmpty=function(){return this.size===0},s.prototype.forEach=function(a){if(!(this.isEmpty()||typeof a!="function"))for(var u=0,h=this.clone();!h.isEmpty();)a(h.poll(),u++)},s.prototype.kSmallest=function(a){if(this.size==0)return[];var u=this.compare,h=this.array,d=new s(function(b,V){return u(h[b],h[V])});a=Math.min(this.size,a);var c=new Array(a),g=0;for(d.add(0);g<a;){var p=d.poll();c[g++]=this.array[p];var x=(p<<1)+1,y=x+1;x<this.size&&d.add(x),y<this.size&&d.add(y)}return c};var o=function(){var a=new s(function(u,h){return u<h});for(a.add(1),a.add(0),a.add(5),a.add(4),a.add(3);!a.isEmpty();)console.log(a.poll())};ra.main===r&&o(),r.exports=s});function sa(){let r=0;function i(s){r=r||Math.floor(Math.sqrt(s.reduce(c=>c+1,0))+.5),s.each(c=>{c._before=[],c._parents=[]}).each(c=>c.children.forEach(g=>g._parents.push(c)));let o=ia((c,g)=>{for(let p=0;p<c._before.length;++p){if(p>=g._before.length)return!1;if(c._before[p]<g._before[p])return!0;if(g._before[p]<c._before[p])return!1}return!0});s.roots().forEach(c=>o.add(c));let a=0,u=0,h=0,d;for(;d=o.poll();)h<r&&d._parents.every(c=>c.layer<u)?(d.layer=u,h++):(d.layer=++u,h=1),d.children.forEach(c=>{c._before.push(a),c._before.length===c._parents.length&&(c._before.sort((g,p)=>p-g),o.add(c))}),a++;return s.each(c=>{delete c._before,delete c._parents}),s}return i.width=function(s){return arguments.length?(r=s,i):r},i}function mn(){let r=!0;function i(s){if(r){let o=Math.max(...s.height().roots().map(a=>a.value));s.each(a=>{a.layer=o-a.value})}else s.depth(),s.each(o=>{o.layer=o.value});return s}return i.topDown=function(s){return arguments.length?(r=s,i):r},i}function vn(){let r=!1;function i(s){let o=r?"":"\0",a=r?" -> ":"\0",u={},h={},d={};s.each(g=>{let p=`${o}${g.id}`;h[p]=1;let x=u[p]={opt:g.children.length};g.children.forEach(y=>{let b=`${g.id}${a}${y.id}`;d[b]={min:1},x[b]=-1})}),s.each(g=>{g.children.forEach(p=>{let x=u[`${o}${p.id}`];x.opt--,x[`${g.id}${a}${p.id}`]=1})});let c=Ir.Solve({optimize:"opt",opType:"max",constraints:d,variables:u,ints:h});return s.each(g=>g.layer=c[`${o}${g.id}`]||0),s}return i.debug=function(s){return arguments.length?(r=s,i):r},i}function aa(){function r(i){let s=0;return i.eachBefore(o=>o.layer=s++),i}return r}function oa(){let r=!1,i=!1,s=1,o=1,a=vn(),u=Br(),h=n(),d=ua;function c(x){let y=[];return x.descendants().forEach(b=>{(y[b.layer]||(y[b.layer]=[])).push(b),b.children=b.children.map(w=>{if(w.layer>b.layer+1){let z=w;for(let B=w.layer-1;B>b.layer;B--){let k=new pt(`${b.id}${r?"->":"\0"}${w.id}${r?" (":"\0"}${B}${r?")":""}`,void 0);k.children=[z],(y[B]||(y[B]=[])).push(k),z=k}return z}else return w})}),y}function g(x){x.each(y=>{y.data&&(y.children=y.children.map((b,V)=>{let w=[{x:y.x,y:y.y}];for(;!b.data;)w.push({x:b.x,y:b.y}),[b]=b.children;return w.push({x:b.x,y:b.y}),y._childLinkData[V].points=w,b}))})}function p(x){if(a(x),!x.every(b=>b.children.every(V=>V.layer>b.layer)))throw new Error("layering wasn't proper");let y=c(x);if(y.length===1){let[b]=y;b.forEach(V=>V.y=o/2)}else{let b=i?o:o/(y.length-1);y.forEach((V,w)=>V.forEach(z=>z.y=b*w))}if(y.every(b=>b.length===1))y.forEach(([b])=>b.x=s/2);else{u(y),h(y,d);let b=Math.min(...y.filter(w=>w.length>1).map(w=>Math.min(...w.slice(1).map((z,B)=>z.x-w[B].x)))),V=i?b:1;y.forEach(w=>w.forEach(z=>z.x*=s/V))}return g(x),x}return p.debug=function(x){return arguments.length?(r=x,p):r},p.size=function(x){return arguments.length?(i=!1,[s,o]=x,p):i?null:[s,o]},p.nodeSize=function(x){return arguments.length?(i=!0,[s,o]=x,p):i?[s,o]:null},p.layering=function(x){return arguments.length?(a=x,p):a},p.decross=function(x){return arguments.length?(u=x,p):u},p.coord=function(x){return arguments.length?(h=x,p):h},p.separation=function(x){return arguments.length?(d=x,p):d},p}function ua(){return 1}function la(){function r(i,s){s.forEach(o=>{o._mean=0,o._count=0}),i.forEach((o,a)=>o.children.forEach(u=>u._mean+=(a-u._mean)/++u._count)),s.sort((o,a)=>o._mean-a._mean),s.forEach(o=>{delete o._mean,delete o._count})}return r}let gn="crossings";function ha(){let r=!1;function i(...u){return u.map(h=>h.id).sort().join(r?" => ":"\0\0")}function s(u,h){h.sort((d,c)=>d.id>c.id||-1),h.slice(0,h.length-1).forEach((d,c)=>h.slice(c+1).forEach(g=>{let p=i(d,g);u.ints[p]=1,u.constraints[p]={max:1},u.variables[p]={[p]:1}})),h.slice(0,h.length-1).forEach((d,c)=>h.slice(c+1).forEach((g,p)=>{let x=i(d,g);h.slice(c+p+2).forEach(y=>{let b=i(d,y),V=i(g,y),w=i(d,g,y),z=w+"+";u.constraints[z]={max:1},u.variables[x][z]=1,u.variables[b][z]=-1,u.variables[V][z]=1;let B=w+"-";u.constraints[B]={min:0},u.variables[x][B]=1,u.variables[b][B]=-1,u.variables[V][B]=1})}))}function o(u,h){h.slice(0,h.length-1).forEach((d,c)=>h.slice(c+1).forEach(g=>{d.children.forEach(p=>g.children.filter(x=>x!==p).forEach(x=>{let y=i(p,x);u.variables[y][gn]=+(p.id>x.id)||-1}))}))}function a(u,h){let d={optimize:gn,optType:"min",constraints:{},variables:{},ints:{}};s(d,h),o(d,u);let c=Ir.Solve(d);h.sort((g,p)=>(g.id>p.id||-1)*(c[i(g,p)]||-1))}return a.debug=function(u){return arguments.length?(r=u,a):r},a}function fa(){function r(i){let s=[],o=[];i.forEach((a,u)=>{a.childLinks().sort(({target:h},{target:d})=>h.layer-d.layer).forEach(({target:h,data:d})=>{if(h.layer===u+1)d.index=0;else{let c=(o.findIndex(p=>p<=u)+1||o.length+1)-1,g=(s.findIndex(p=>p<=u)+1||s.length+1)-1;c<g?(d.index=-c-1,o[c]=h.layer-1):(d.index=g+1,s[g]=h.layer-1)}})})}return r}function ca(){let r=1,i=1,s=fa();function o(a){let u=[];a.eachBefore((d,c)=>{d.layer=c,u.push(d)});let h=u.length-1;if(h===0){let[d]=u;d.x=r/2,d.y=i/2}else{s(u);let d=0,c=0;a.eachLinks(({data:g})=>{d=Math.min(d,g.index),c=Math.max(c,g.index)}),d===c&&(d=-1,c=1),a.each(g=>{g.x=-d/(c-d)*r,g.y=g.layer/h*i}),a.eachLinks(({source:g,target:p,data:x})=>{let y=[{x:g.x,y:g.y}],b=(x.index-d)/(c-d)*r,V=(g.layer+1)/h*i,w=(p.layer-1)/h*i;p.layer-g.layer===2?y.push({x:b,y:V}):p.layer-g.layer>2&&y.push({x:b,y:V},{x:b,y:w}),y.push({x:p.x,y:p.y}),x.points=y})}return a}return o.size=function(a){return arguments.length?([r,i]=a,o):[r,i]},o}function da(){let r=1,i=1,s=mn().topDown(!1),o=Br(),a=W(),u=O(),h=pa,d=ma,c=va;function g(k){let T=[],$=Math.max(0,...k.descendants().map(A=>A.layer));return k.descendants().forEach(A=>{if((T[A.layer]||(T[A.layer]=[])).push(A),A.children=A.children.map(tt=>{if(tt.layer>A.layer+1){let J=tt;for(let j=tt.layer-1;j>A.layer;j--){let X=new pt(`${A.id}\0${tt.id}\0${j}`,void 0);X.heightRatio=0,X.children=[J],(T[j]||(T[j]=[])).push(X),J=X}return J}else return tt}),A.children.length===0&&A.layer<$){let tt=new pt(`${A.id}\0\0${$}`,void 0);(T[$]||(T[$]=[])).push(tt);let J=tt;for(let j=$-1;j>A.layer;j--){let X=new pt(`${A.id}\0${tt.id}\0${j}`,void 0);X.heightRatio=0,X.children=[J],(T[j]||(T[j]=[])).push(X),J=X}A.children=[J]}}),T}function p(k){k.each(T=>{if(T.data){let $=0;T.children=T.children.map(A=>{let D=[y(T)];for(;A&&!A.data;)D.push(x(A)),[A]=A.children===[]?[null]:A.children;return A!=null&&(D.push(x(A)),T._childLinkData[$].points=D,$++),A}).filter(A=>A!=null)}})}function x(k){return{x:k.x0+(k.x1-k.x0)/2,y:k.y0}}function y(k){return{x:k.x0+(k.x1-k.x0)/2,y:k.y1}}function b(k){k.each(T=>T.children.forEach($=>($.parents||($.parents=[])).push(T)))}function V(k){let T=k.roots().map(w);return Math.max(0,...T)}function w(k){let T=k.children.map(w);return(k.heightRatio||0)+Math.max(0,...T)}function z(k){let T=k.parents?k.parents.map(z):[];return(k.heightRatio||0)+Math.max(0,...T)}function B(k){let T=V(k);if(s(k),!k.every(A=>A.children.every(D=>D.layer>A.layer)))throw new Error("layering wasn't proper");let $=g(k);if($.length===1){let[A]=$;A.forEach(D=>{D.y0=0,D.y1=1})}else{b(k);let A=$.reduce((J,j,X)=>J+(X==0?0:h(j,X)),0),D=T+A,tt=0;$.forEach((J,j)=>{tt+=j==0?0:h(J,j),J.forEach(X=>{let ft=z(X);X.y1=(tt+ft)/D,X.y0=X.y1-X.heightRatio/D})})}return o($),a($),u($,d,c),$.forEach(A=>A.forEach(D=>{D.x0*=r,D.x1*=r,D.y0*=i,D.y1*=i})),p(k),k}return B.size=function(k){return arguments.length?([r,i]=k,B):[r,i]},B.layering=function(k){return arguments.length?(s=k,B):s},B.decross=function(k){return arguments.length?(o=k,B):o},B.columnAssignment=function(k){return arguments.length?(a=k,B):a},B.column2Coord=function(k){return arguments.length?(u=k,B):u},B.interLayerSeparation=function(k){return arguments.length?(h=k,B):h},B.columnWidth=function(k){return arguments.length?(d=k,B):d},B.columnSeparation=function(k){return arguments.length?(c=k,B):c},B}function pa(){return 1}function ma(){return 10}function va(){return 1}t.coordCenter=e,t.coordGreedy=n,t.coordMinCurve=mr,t.coordTopological=M,t.coordVert=F,t.column2CoordRect=O,t.columnSimpleLeft=H,t.columnSimpleCenter=G,t.columnAdjacent=U,t.columnComplex=W,t.dagConnect=Ss,t.dagHierarchy=Os,t.dagStratify=rn,t.decrossOpt=Zs,t.decrossTwoLayer=Br,t.layeringCoffmanGraham=sa,t.layeringLongestPath=mn,t.layeringSimplex=vn,t.layeringTopological=aa,t.sugiyama=oa,t.twolayerMean=la,t.twolayerMedian=pn,t.twolayerOpt=ha,t.zherebko=ca,t.arquint=da,t.dagNode=pt,Object.defineProperty(t,"__esModule",{value:!0})})});var Va={value:()=>{}};function bn(){for(var t=0,e=arguments.length,n={},l;t<e;++t){if(!(l=arguments[t]+"")||l in n||/[\s.]/.test(l))throw new Error("illegal type: "+l);n[l]=[]}return new $e(n)}function $e(t){this._=t}function za(t,e){return t.trim().split(/^|\s+/).map(function(n){var l="",f=n.indexOf(".");if(f>=0&&(l=n.slice(f+1),n=n.slice(0,f)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:l}})}$e.prototype=bn.prototype={constructor:$e,on:function(t,e){var n=this._,l=za(t+"",n),f,m=-1,v=l.length;if(arguments.length<2){for(;++m<v;)if((f=(t=l[m]).type)&&(f=Oa(n[f],t.name)))return f;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++m<v;)if(f=(t=l[m]).type)n[f]=_n(n[f],t.name,e);else if(e==null)for(f in n)n[f]=_n(n[f],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new $e(t)},call:function(t,e){if((f=arguments.length-2)>0)for(var n=new Array(f),l=0,f,m;l<f;++l)n[l]=arguments[l+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(m=this._[t],l=0,f=m.length;l<f;++l)m[l].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var l=this._[t],f=0,m=l.length;f<m;++f)l[f].value.apply(e,n)}};function Oa(t,e){for(var n=0,l=t.length,f;n<l;++n)if((f=t[n]).name===e)return f.value}function _n(t,e,n){for(var l=0,f=t.length;l<f;++l)if(t[l].name===e){t[l]=Va,t=t.slice(0,l).concat(t.slice(l+1));break}return n!=null&&t.push({name:e,value:n}),t}var pe=bn;var Ne="http://www.w3.org/1999/xhtml",Vr={svg:"http://www.w3.org/2000/svg",xhtml:Ne,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Lt(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),Vr.hasOwnProperty(e)?{space:Vr[e],local:t}:t}function Aa(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Ne&&e.documentElement.namespaceURI===Ne?e.createElement(t):e.createElementNS(n,t)}}function Ta(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Re(t){var e=Lt(t);return(e.local?Ta:Aa)(e)}function $a(){}function te(t){return t==null?$a:function(){return this.querySelector(t)}}function wn(t){typeof t!="function"&&(t=te(t));for(var e=this._groups,n=e.length,l=new Array(n),f=0;f<n;++f)for(var m=e[f],v=m.length,E=l[f]=new Array(v),I,C,S=0;S<v;++S)(I=m[S])&&(C=t.call(I,I.__data__,S,m))&&("__data__"in I&&(C.__data__=I.__data__),E[S]=C);return new st(l,this._parents)}function zr(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function Na(){return[]}function me(t){return t==null?Na:function(){return this.querySelectorAll(t)}}function Ra(t){return function(){return zr(t.apply(this,arguments))}}function En(t){typeof t=="function"?t=Ra(t):t=me(t);for(var e=this._groups,n=e.length,l=[],f=[],m=0;m<n;++m)for(var v=e[m],E=v.length,I,C=0;C<E;++C)(I=v[C])&&(l.push(t.call(I,I.__data__,C,v)),f.push(I));return new st(l,f)}function ve(t){return function(){return this.matches(t)}}function De(t){return function(e){return e.matches(t)}}var Da=Array.prototype.find;function La(t){return function(){return Da.call(this.children,t)}}function Pa(){return this.firstElementChild}function In(t){return this.select(t==null?Pa:La(typeof t=="function"?t:De(t)))}var qa=Array.prototype.filter;function Fa(){return Array.from(this.children)}function Ha(t){return function(){return qa.call(this.children,t)}}function Cn(t){return this.selectAll(t==null?Fa:Ha(typeof t=="function"?t:De(t)))}function Mn(t){typeof t!="function"&&(t=ve(t));for(var e=this._groups,n=e.length,l=new Array(n),f=0;f<n;++f)for(var m=e[f],v=m.length,E=l[f]=[],I,C=0;C<v;++C)(I=m[C])&&t.call(I,I.__data__,C,m)&&E.push(I);return new st(l,this._parents)}function Le(t){return new Array(t.length)}function Bn(){return new st(this._enter||this._groups.map(Le),this._parents)}function ge(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}ge.prototype={constructor:ge,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Sn(t){return function(){return t}}function ja(t,e,n,l,f,m){for(var v=0,E,I=e.length,C=m.length;v<C;++v)(E=e[v])?(E.__data__=m[v],l[v]=E):n[v]=new ge(t,m[v]);for(;v<I;++v)(E=e[v])&&(f[v]=E)}function Xa(t,e,n,l,f,m,v){var E,I,C=new Map,S=e.length,N=m.length,R=new Array(S),P;for(E=0;E<S;++E)(I=e[E])&&(R[E]=P=v.call(I,I.__data__,E,e)+"",C.has(P)?f[E]=I:C.set(P,I));for(E=0;E<N;++E)P=v.call(t,m[E],E,m)+"",(I=C.get(P))?(l[E]=I,I.__data__=m[E],C.delete(P)):n[E]=new ge(t,m[E]);for(E=0;E<S;++E)(I=e[E])&&C.get(R[E])===I&&(f[E]=I)}function Ya(t){return t.__data__}function kn(t,e){if(!arguments.length)return Array.from(this,Ya);var n=e?Xa:ja,l=this._parents,f=this._groups;typeof t!="function"&&(t=Sn(t));for(var m=f.length,v=new Array(m),E=new Array(m),I=new Array(m),C=0;C<m;++C){var S=l[C],N=f[C],R=N.length,P=Ga(t.call(S,S&&S.__data__,C,l)),q=P.length,K=E[C]=new Array(q),it=v[C]=new Array(q),Y=I[C]=new Array(R);n(S,N,K,it,Y,P,e);for(var lt=0,dt=0,wt,xt;lt<q;++lt)if(wt=K[lt]){for(lt>=dt&&(dt=lt+1);!(xt=it[dt])&&++dt<q;);wt._next=xt||null}}return v=new st(v,l),v._enter=E,v._exit=I,v}function Ga(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Vn(){return new st(this._exit||this._groups.map(Le),this._parents)}function zn(t,e,n){var l=this.enter(),f=this,m=this.exit();return typeof t=="function"?(l=t(l),l&&(l=l.selection())):l=l.append(t+""),e!=null&&(f=e(f),f&&(f=f.selection())),n==null?m.remove():n(m),l&&f?l.merge(f).order():f}function On(t){for(var e=t.selection?t.selection():t,n=this._groups,l=e._groups,f=n.length,m=l.length,v=Math.min(f,m),E=new Array(f),I=0;I<v;++I)for(var C=n[I],S=l[I],N=C.length,R=E[I]=new Array(N),P,q=0;q<N;++q)(P=C[q]||S[q])&&(R[q]=P);for(;I<f;++I)E[I]=n[I];return new st(E,this._parents)}function An(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var l=t[e],f=l.length-1,m=l[f],v;--f>=0;)(v=l[f])&&(m&&v.compareDocumentPosition(m)^4&&m.parentNode.insertBefore(v,m),m=v);return this}function Tn(t){t||(t=Ua);function e(N,R){return N&&R?t(N.__data__,R.__data__):!N-!R}for(var n=this._groups,l=n.length,f=new Array(l),m=0;m<l;++m){for(var v=n[m],E=v.length,I=f[m]=new Array(E),C,S=0;S<E;++S)(C=v[S])&&(I[S]=C);I.sort(e)}return new st(f,this._parents).order()}function Ua(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function $n(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Nn(){return Array.from(this)}function Rn(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var l=t[e],f=0,m=l.length;f<m;++f){var v=l[f];if(v)return v}return null}function Dn(){let t=0;for(let e of this)++t;return t}function Ln(){return!this.node()}function Pn(t){for(var e=this._groups,n=0,l=e.length;n<l;++n)for(var f=e[n],m=0,v=f.length,E;m<v;++m)(E=f[m])&&t.call(E,E.__data__,m,f);return this}function Wa(t){return function(){this.removeAttribute(t)}}function Ka(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Za(t,e){return function(){this.setAttribute(t,e)}}function Ja(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Qa(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function to(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function qn(t,e){var n=Lt(t);if(arguments.length<2){var l=this.node();return n.local?l.getAttributeNS(n.space,n.local):l.getAttribute(n)}return this.each((e==null?n.local?Ka:Wa:typeof e=="function"?n.local?to:Qa:n.local?Ja:Za)(n,e))}function Pe(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function eo(t){return function(){this.style.removeProperty(t)}}function ro(t,e,n){return function(){this.style.setProperty(t,e,n)}}function no(t,e,n){return function(){var l=e.apply(this,arguments);l==null?this.style.removeProperty(t):this.style.setProperty(t,l,n)}}function Fn(t,e,n){return arguments.length>1?this.each((e==null?eo:typeof e=="function"?no:ro)(t,e,n??"")):Ut(this.node(),t)}function Ut(t,e){return t.style.getPropertyValue(e)||Pe(t).getComputedStyle(t,null).getPropertyValue(e)}function io(t){return function(){delete this[t]}}function so(t,e){return function(){this[t]=e}}function ao(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function Hn(t,e){return arguments.length>1?this.each((e==null?io:typeof e=="function"?ao:so)(t,e)):this.node()[t]}function jn(t){return t.trim().split(/^|\s+/)}function Or(t){return t.classList||new Xn(t)}function Xn(t){this._node=t,this._names=jn(t.getAttribute("class")||"")}Xn.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Yn(t,e){for(var n=Or(t),l=-1,f=e.length;++l<f;)n.add(e[l])}function Gn(t,e){for(var n=Or(t),l=-1,f=e.length;++l<f;)n.remove(e[l])}function oo(t){return function(){Yn(this,t)}}function uo(t){return function(){Gn(this,t)}}function lo(t,e){return function(){(e.apply(this,arguments)?Yn:Gn)(this,t)}}function Un(t,e){var n=jn(t+"");if(arguments.length<2){for(var l=Or(this.node()),f=-1,m=n.length;++f<m;)if(!l.contains(n[f]))return!1;return!0}return this.each((typeof e=="function"?lo:e?oo:uo)(n,e))}function ho(){this.textContent=""}function fo(t){return function(){this.textContent=t}}function co(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function Wn(t){return arguments.length?this.each(t==null?ho:(typeof t=="function"?co:fo)(t)):this.node().textContent}function po(){this.innerHTML=""}function mo(t){return function(){this.innerHTML=t}}function vo(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function Kn(t){return arguments.length?this.each(t==null?po:(typeof t=="function"?vo:mo)(t)):this.node().innerHTML}function go(){this.nextSibling&&this.parentNode.appendChild(this)}function Zn(){return this.each(go)}function xo(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Jn(){return this.each(xo)}function Qn(t){var e=typeof t=="function"?t:Re(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function yo(){return null}function ti(t,e){var n=typeof t=="function"?t:Re(t),l=e==null?yo:typeof e=="function"?e:te(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),l.apply(this,arguments)||null)})}function _o(){var t=this.parentNode;t&&t.removeChild(this)}function ei(){return this.each(_o)}function bo(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function wo(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function ri(t){return this.select(t?wo:bo)}function ni(t){return arguments.length?this.property("__data__",t):this.node().__data__}function Eo(t){return function(e){t.call(this,e,this.__data__)}}function Io(t){return t.trim().split(/^|\s+/).map(function(e){var n="",l=e.indexOf(".");return l>=0&&(n=e.slice(l+1),e=e.slice(0,l)),{type:e,name:n}})}function Co(t){return function(){var e=this.__on;if(e){for(var n=0,l=-1,f=e.length,m;n<f;++n)m=e[n],(!t.type||m.type===t.type)&&m.name===t.name?this.removeEventListener(m.type,m.listener,m.options):e[++l]=m;++l?e.length=l:delete this.__on}}}function Mo(t,e,n){return function(){var l=this.__on,f,m=Eo(e);if(l){for(var v=0,E=l.length;v<E;++v)if((f=l[v]).type===t.type&&f.name===t.name){this.removeEventListener(f.type,f.listener,f.options),this.addEventListener(f.type,f.listener=m,f.options=n),f.value=e;return}}this.addEventListener(t.type,m,n),f={type:t.type,name:t.name,value:e,listener:m,options:n},l?l.push(f):this.__on=[f]}}function ii(t,e,n){var l=Io(t+""),f,m=l.length,v;if(arguments.length<2){var E=this.node().__on;if(E){for(var I=0,C=E.length,S;I<C;++I)for(f=0,S=E[I];f<m;++f)if((v=l[f]).type===S.type&&v.name===S.name)return S.value}return}for(E=e?Mo:Co,f=0;f<m;++f)this.each(E(l[f],e,n));return this}function si(t,e,n){var l=Pe(t),f=l.CustomEvent;typeof f=="function"?f=new f(e,n):(f=l.document.createEvent("Event"),n?(f.initEvent(e,n.bubbles,n.cancelable),f.detail=n.detail):f.initEvent(e,!1,!1)),t.dispatchEvent(f)}function Bo(t,e){return function(){return si(this,t,e)}}function So(t,e){return function(){return si(this,t,e.apply(this,arguments))}}function ai(t,e){return this.each((typeof e=="function"?So:Bo)(t,e))}function*oi(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var l=t[e],f=0,m=l.length,v;f<m;++f)(v=l[f])&&(yield v)}var Ar=[null];function st(t,e){this._groups=t,this._parents=e}function ui(){return new st([[document.documentElement]],Ar)}function ko(){return this}st.prototype=ui.prototype={constructor:st,select:wn,selectAll:En,selectChild:In,selectChildren:Cn,filter:Mn,data:kn,enter:Bn,exit:Vn,join:zn,merge:On,selection:ko,order:An,sort:Tn,call:$n,nodes:Nn,node:Rn,size:Dn,empty:Ln,each:Pn,attr:qn,style:Fn,property:Hn,classed:Un,text:Wn,html:Kn,raise:Zn,lower:Jn,append:Qn,insert:ti,remove:ei,clone:ri,datum:ni,on:ii,dispatch:ai,[Symbol.iterator]:oi};var Pt=ui;function bt(t){return typeof t=="string"?new st([[document.querySelector(t)]],[document.documentElement]):new st([[t]],Ar)}function li(t){let e;for(;e=t.sourceEvent;)t=e;return t}function qt(t,e){if(t=li(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var l=n.createSVGPoint();return l.x=t.clientX,l.y=t.clientY,l=l.matrixTransform(e.getScreenCTM().inverse()),[l.x,l.y]}if(e.getBoundingClientRect){var f=e.getBoundingClientRect();return[t.clientX-f.left-e.clientLeft,t.clientY-f.top-e.clientTop]}}return[t.pageX,t.pageY]}var qe={capture:!0,passive:!1};function Fe(t){t.preventDefault(),t.stopImmediatePropagation()}function Tr(t){var e=t.document.documentElement,n=bt(t).on("dragstart.drag",Fe,qe);"onselectstart"in e?n.on("selectstart.drag",Fe,qe):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function $r(t,e){var n=t.document.documentElement,l=bt(t).on("dragstart.drag",null);e&&(l.on("click.drag",Fe,qe),setTimeout(function(){l.on("click.drag",null)},0)),"onselectstart"in n?l.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}function He(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Nr(t,e){var n=Object.create(t.prototype);for(var l in e)n[l]=e[l];return n}function _e(){}var xe=.7,Ye=1/xe,se="\\s*([+-]?\\d+)\\s*",ye="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Nt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Vo=/^#([0-9a-f]{3,8})$/,zo=new RegExp(`^rgb\\(${se},${se},${se}\\)$`),Oo=new RegExp(`^rgb\\(${Nt},${Nt},${Nt}\\)$`),Ao=new RegExp(`^rgba\\(${se},${se},${se},${ye}\\)$`),To=new RegExp(`^rgba\\(${Nt},${Nt},${Nt},${ye}\\)$`),$o=new RegExp(`^hsl\\(${ye},${Nt},${Nt}\\)$`),No=new RegExp(`^hsla\\(${ye},${Nt},${Nt},${ye}\\)$`),hi={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};He(_e,Wt,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:fi,formatHex:fi,formatHex8:Ro,formatHsl:Do,formatRgb:ci,toString:ci});function fi(){return this.rgb().formatHex()}function Ro(){return this.rgb().formatHex8()}function Do(){return xi(this).formatHsl()}function ci(){return this.rgb().formatRgb()}function Wt(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Vo.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?di(e):n===3?new gt(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?je(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?je(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=zo.exec(t))?new gt(e[1],e[2],e[3],1):(e=Oo.exec(t))?new gt(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Ao.exec(t))?je(e[1],e[2],e[3],e[4]):(e=To.exec(t))?je(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=$o.exec(t))?vi(e[1],e[2]/100,e[3]/100,1):(e=No.exec(t))?vi(e[1],e[2]/100,e[3]/100,e[4]):hi.hasOwnProperty(t)?di(hi[t]):t==="transparent"?new gt(NaN,NaN,NaN,0):null}function di(t){return new gt(t>>16&255,t>>8&255,t&255,1)}function je(t,e,n,l){return l<=0&&(t=e=n=NaN),new gt(t,e,n,l)}function Lo(t){return t instanceof _e||(t=Wt(t)),t?(t=t.rgb(),new gt(t.r,t.g,t.b,t.opacity)):new gt}function ae(t,e,n,l){return arguments.length===1?Lo(t):new gt(t,e,n,l??1)}function gt(t,e,n,l){this.r=+t,this.g=+e,this.b=+n,this.opacity=+l}He(gt,ae,Nr(_e,{brighter(t){return t=t==null?Ye:Math.pow(Ye,t),new gt(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?xe:Math.pow(xe,t),new gt(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new gt(re(this.r),re(this.g),re(this.b),Ge(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:pi,formatHex:pi,formatHex8:Po,formatRgb:mi,toString:mi}));function pi(){return`#${ee(this.r)}${ee(this.g)}${ee(this.b)}`}function Po(){return`#${ee(this.r)}${ee(this.g)}${ee(this.b)}${ee((isNaN(this.opacity)?1:this.opacity)*255)}`}function mi(){let t=Ge(this.opacity);return`${t===1?"rgb(":"rgba("}${re(this.r)}, ${re(this.g)}, ${re(this.b)}${t===1?")":`, ${t})`}`}function Ge(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function re(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function ee(t){return t=re(t),(t<16?"0":"")+t.toString(16)}function vi(t,e,n,l){return l<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Ot(t,e,n,l)}function xi(t){if(t instanceof Ot)return new Ot(t.h,t.s,t.l,t.opacity);if(t instanceof _e||(t=Wt(t)),!t)return new Ot;if(t instanceof Ot)return t;t=t.rgb();var e=t.r/255,n=t.g/255,l=t.b/255,f=Math.min(e,n,l),m=Math.max(e,n,l),v=NaN,E=m-f,I=(m+f)/2;return E?(e===m?v=(n-l)/E+(n<l)*6:n===m?v=(l-e)/E+2:v=(e-n)/E+4,E/=I<.5?m+f:2-m-f,v*=60):E=I>0&&I<1?0:v,new Ot(v,E,I,t.opacity)}function yi(t,e,n,l){return arguments.length===1?xi(t):new Ot(t,e,n,l??1)}function Ot(t,e,n,l){this.h=+t,this.s=+e,this.l=+n,this.opacity=+l}He(Ot,yi,Nr(_e,{brighter(t){return t=t==null?Ye:Math.pow(Ye,t),new Ot(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?xe:Math.pow(xe,t),new Ot(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,l=n+(n<.5?n:1-n)*e,f=2*n-l;return new gt(Rr(t>=240?t-240:t+120,f,l),Rr(t,f,l),Rr(t<120?t+240:t-120,f,l),this.opacity)},clamp(){return new Ot(gi(this.h),Xe(this.s),Xe(this.l),Ge(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let t=Ge(this.opacity);return`${t===1?"hsl(":"hsla("}${gi(this.h)}, ${Xe(this.s)*100}%, ${Xe(this.l)*100}%${t===1?")":`, ${t})`}`}}));function gi(t){return t=(t||0)%360,t<0?t+360:t}function Xe(t){return Math.max(0,Math.min(1,t||0))}function Rr(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}function Dr(t,e,n,l,f){var m=t*t,v=m*t;return((1-3*t+3*m-v)*e+(4-6*m+3*v)*n+(1+3*t+3*m-3*v)*l+v*f)/6}function _i(t){var e=t.length-1;return function(n){var l=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),f=t[l],m=t[l+1],v=l>0?t[l-1]:2*f-m,E=l<e-1?t[l+2]:2*m-f;return Dr((n-l/e)*e,v,f,m,E)}}function bi(t){var e=t.length;return function(n){var l=Math.floor(((n%=1)<0?++n:n)*e),f=t[(l+e-1)%e],m=t[l%e],v=t[(l+1)%e],E=t[(l+2)%e];return Dr((n-l/e)*e,f,m,v,E)}}var Lr=t=>()=>t;function qo(t,e){return function(n){return t+n*e}}function Fo(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(l){return Math.pow(t+l*e,n)}}function wi(t){return(t=+t)==1?Ue:function(e,n){return n-e?Fo(e,n,t):Lr(isNaN(e)?n:e)}}function Ue(t,e){var n=e-t;return n?qo(t,n):Lr(isNaN(t)?e:t)}var We=function t(e){var n=wi(e);function l(f,m){var v=n((f=ae(f)).r,(m=ae(m)).r),E=n(f.g,m.g),I=n(f.b,m.b),C=Ue(f.opacity,m.opacity);return function(S){return f.r=v(S),f.g=E(S),f.b=I(S),f.opacity=C(S),f+""}}return l.gamma=t,l}(1);function Ei(t){return function(e){var n=e.length,l=new Array(n),f=new Array(n),m=new Array(n),v,E;for(v=0;v<n;++v)E=ae(e[v]),l[v]=E.r||0,f[v]=E.g||0,m[v]=E.b||0;return l=t(l),f=t(f),m=t(m),E.opacity=1,function(I){return E.r=l(I),E.g=f(I),E.b=m(I),E+""}}}var Ho=Ei(_i),jo=Ei(bi);function Ct(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var qr=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Pr=new RegExp(qr.source,"g");function Xo(t){return function(){return t}}function Yo(t){return function(e){return t(e)+""}}function Fr(t,e){var n=qr.lastIndex=Pr.lastIndex=0,l,f,m,v=-1,E=[],I=[];for(t=t+"",e=e+"";(l=qr.exec(t))&&(f=Pr.exec(e));)(m=f.index)>n&&(m=e.slice(n,m),E[v]?E[v]+=m:E[++v]=m),(l=l[0])===(f=f[0])?E[v]?E[v]+=f:E[++v]=f:(E[++v]=null,I.push({i:v,x:Ct(l,f)})),n=Pr.lastIndex;return n<e.length&&(m=e.slice(n),E[v]?E[v]+=m:E[++v]=m),E.length<2?I[0]?Yo(I[0].x):Xo(e):(e=I.length,function(C){for(var S=0,N;S<e;++S)E[(N=I[S]).i]=N.x(C);return E.join("")})}var Ii=180/Math.PI,Ke={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Hr(t,e,n,l,f,m){var v,E,I;return(v=Math.sqrt(t*t+e*e))&&(t/=v,e/=v),(I=t*n+e*l)&&(n-=t*I,l-=e*I),(E=Math.sqrt(n*n+l*l))&&(n/=E,l/=E,I/=E),t*l<e*n&&(t=-t,e=-e,I=-I,v=-v),{translateX:f,translateY:m,rotate:Math.atan2(e,t)*Ii,skewX:Math.atan(I)*Ii,scaleX:v,scaleY:E}}var Ze;function Ci(t){let e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Ke:Hr(e.a,e.b,e.c,e.d,e.e,e.f)}function Mi(t){return t==null?Ke:(Ze||(Ze=document.createElementNS("http://www.w3.org/2000/svg","g")),Ze.setAttribute("transform",t),(t=Ze.transform.baseVal.consolidate())?(t=t.matrix,Hr(t.a,t.b,t.c,t.d,t.e,t.f)):Ke)}function Bi(t,e,n,l){function f(C){return C.length?C.pop()+" ":""}function m(C,S,N,R,P,q){if(C!==N||S!==R){var K=P.push("translate(",null,e,null,n);q.push({i:K-4,x:Ct(C,N)},{i:K-2,x:Ct(S,R)})}else(N||R)&&P.push("translate("+N+e+R+n)}function v(C,S,N,R){C!==S?(C-S>180?S+=360:S-C>180&&(C+=360),R.push({i:N.push(f(N)+"rotate(",null,l)-2,x:Ct(C,S)})):S&&N.push(f(N)+"rotate("+S+l)}function E(C,S,N,R){C!==S?R.push({i:N.push(f(N)+"skewX(",null,l)-2,x:Ct(C,S)}):S&&N.push(f(N)+"skewX("+S+l)}function I(C,S,N,R,P,q){if(C!==N||S!==R){var K=P.push(f(P)+"scale(",null,",",null,")");q.push({i:K-4,x:Ct(C,N)},{i:K-2,x:Ct(S,R)})}else(N!==1||R!==1)&&P.push(f(P)+"scale("+N+","+R+")")}return function(C,S){var N=[],R=[];return C=t(C),S=t(S),m(C.translateX,C.translateY,S.translateX,S.translateY,N,R),v(C.rotate,S.rotate,N,R),E(C.skewX,S.skewX,N,R),I(C.scaleX,C.scaleY,S.scaleX,S.scaleY,N,R),C=S=null,function(P){for(var q=-1,K=R.length,it;++q<K;)N[(it=R[q]).i]=it.x(P);return N.join("")}}}var jr=Bi(Ci,"px, ","px)","deg)"),Xr=Bi(Mi,", ",")",")");var Go=1e-12;function Si(t){return((t=Math.exp(t))+1/t)/2}function Uo(t){return((t=Math.exp(t))-1/t)/2}function Wo(t){return((t=Math.exp(2*t))-1)/(t+1)}var Yr=function t(e,n,l){function f(m,v){var E=m[0],I=m[1],C=m[2],S=v[0],N=v[1],R=v[2],P=S-E,q=N-I,K=P*P+q*q,it,Y;if(K<Go)Y=Math.log(R/C)/e,it=function(Et){return[E+Et*P,I+Et*q,C*Math.exp(e*Et*Y)]};else{var lt=Math.sqrt(K),dt=(R*R-C*C+l*K)/(2*C*n*lt),wt=(R*R-C*C-l*K)/(2*R*n*lt),xt=Math.log(Math.sqrt(dt*dt+1)-dt),vt=Math.log(Math.sqrt(wt*wt+1)-wt);Y=(vt-xt)/e,it=function(Et){var Ht=Et*Y,jt=Si(xt),Xt=C/(n*lt)*(jt*Wo(e*Ht+xt)-Uo(xt));return[E+Xt*P,I+Xt*q,C*jt/Si(e*Ht+xt)]}}return it.duration=Y*1e3*e/Math.SQRT2,it}return f.rho=function(m){var v=Math.max(.001,+m),E=v*v,I=E*E;return t(v,E,I)},f}(Math.SQRT2,2,4);var oe=0,we=0,be=0,Vi=1e3,Je,Ee,Qe=0,ne=0,tr=0,Ie=typeof performance=="object"&&performance.now?performance:Date,zi=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Me(){return ne||(zi(Ko),ne=Ie.now()+tr)}function Ko(){ne=0}function Ce(){this._call=this._time=this._next=null}Ce.prototype=er.prototype={constructor:Ce,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?Me():+n)+(e==null?0:+e),!this._next&&Ee!==this&&(Ee?Ee._next=this:Je=this,Ee=this),this._call=t,this._time=n,Gr()},stop:function(){this._call&&(this._call=null,this._time=1/0,Gr())}};function er(t,e,n){var l=new Ce;return l.restart(t,e,n),l}function Oi(){Me(),++oe;for(var t=Je,e;t;)(e=ne-t._time)>=0&&t._call.call(void 0,e),t=t._next;--oe}function ki(){ne=(Qe=Ie.now())+tr,oe=we=0;try{Oi()}finally{oe=0,Jo(),ne=0}}function Zo(){var t=Ie.now(),e=t-Qe;e>Vi&&(tr-=e,Qe=t)}function Jo(){for(var t,e=Je,n,l=1/0;e;)e._call?(l>e._time&&(l=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:Je=n);Ee=t,Gr(l)}function Gr(t){if(!oe){we&&(we=clearTimeout(we));var e=t-ne;e>24?(t<1/0&&(we=setTimeout(ki,t-Ie.now()-tr)),be&&(be=clearInterval(be))):(be||(Qe=Ie.now(),be=setInterval(Zo,Vi)),oe=1,zi(ki))}}function rr(t,e,n){var l=new Ce;return e=e==null?0:+e,l.restart(f=>{l.stop(),t(f+e)},e,n),l}var Qo=pe("start","end","cancel","interrupt"),tu=[],$i=0,Ai=1,ir=2,nr=3,Ti=4,sr=5,Be=6;function Kt(t,e,n,l,f,m){var v=t.__transition;if(!v)t.__transition={};else if(n in v)return;eu(t,n,{name:e,index:l,group:f,on:Qo,tween:tu,time:m.time,delay:m.delay,duration:m.duration,ease:m.ease,timer:null,state:$i})}function Se(t,e){var n=ut(t,e);if(n.state>$i)throw new Error("too late; already scheduled");return n}function ct(t,e){var n=ut(t,e);if(n.state>nr)throw new Error("too late; already running");return n}function ut(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function eu(t,e,n){var l=t.__transition,f;l[e]=n,n.timer=er(m,0,n.time);function m(C){n.state=Ai,n.timer.restart(v,n.delay,n.time),n.delay<=C&&v(C-n.delay)}function v(C){var S,N,R,P;if(n.state!==Ai)return I();for(S in l)if(P=l[S],P.name===n.name){if(P.state===nr)return rr(v);P.state===Ti?(P.state=Be,P.timer.stop(),P.on.call("interrupt",t,t.__data__,P.index,P.group),delete l[S]):+S<e&&(P.state=Be,P.timer.stop(),P.on.call("cancel",t,t.__data__,P.index,P.group),delete l[S])}if(rr(function(){n.state===nr&&(n.state=Ti,n.timer.restart(E,n.delay,n.time),E(C))}),n.state=ir,n.on.call("start",t,t.__data__,n.index,n.group),n.state===ir){for(n.state=nr,f=new Array(R=n.tween.length),S=0,N=-1;S<R;++S)(P=n.tween[S].value.call(t,t.__data__,n.index,n.group))&&(f[++N]=P);f.length=N+1}}function E(C){for(var S=C<n.duration?n.ease.call(null,C/n.duration):(n.timer.restart(I),n.state=sr,1),N=-1,R=f.length;++N<R;)f[N].call(t,S);n.state===sr&&(n.on.call("end",t,t.__data__,n.index,n.group),I())}function I(){n.state=Be,n.timer.stop(),delete l[e];for(var C in l)return;delete t.__transition}}function Zt(t,e){var n=t.__transition,l,f,m=!0,v;if(n){e=e==null?null:e+"";for(v in n){if((l=n[v]).name!==e){m=!1;continue}f=l.state>ir&&l.state<sr,l.state=Be,l.timer.stop(),l.on.call(f?"interrupt":"cancel",t,t.__data__,l.index,l.group),delete n[v]}m&&delete t.__transition}}function Ni(t){return this.each(function(){Zt(this,t)})}function ru(t,e){var n,l;return function(){var f=ct(this,t),m=f.tween;if(m!==n){l=n=m;for(var v=0,E=l.length;v<E;++v)if(l[v].name===e){l=l.slice(),l.splice(v,1);break}}f.tween=l}}function nu(t,e,n){var l,f;if(typeof n!="function")throw new Error;return function(){var m=ct(this,t),v=m.tween;if(v!==l){f=(l=v).slice();for(var E={name:e,value:n},I=0,C=f.length;I<C;++I)if(f[I].name===e){f[I]=E;break}I===C&&f.push(E)}m.tween=f}}function Ri(t,e){var n=this._id;if(t+="",arguments.length<2){for(var l=ut(this.node(),n).tween,f=0,m=l.length,v;f<m;++f)if((v=l[f]).name===t)return v.value;return null}return this.each((e==null?ru:nu)(n,t,e))}function ue(t,e,n){var l=t._id;return t.each(function(){var f=ct(this,l);(f.value||(f.value={}))[e]=n.apply(this,arguments)}),function(f){return ut(f,l).value[e]}}function ar(t,e){var n;return(typeof e=="number"?Ct:e instanceof Wt?We:(n=Wt(e))?(e=n,We):Fr)(t,e)}function iu(t){return function(){this.removeAttribute(t)}}function su(t){return function(){this.removeAttributeNS(t.space,t.local)}}function au(t,e,n){var l,f=n+"",m;return function(){var v=this.getAttribute(t);return v===f?null:v===l?m:m=e(l=v,n)}}function ou(t,e,n){var l,f=n+"",m;return function(){var v=this.getAttributeNS(t.space,t.local);return v===f?null:v===l?m:m=e(l=v,n)}}function uu(t,e,n){var l,f,m;return function(){var v,E=n(this),I;return E==null?void this.removeAttribute(t):(v=this.getAttribute(t),I=E+"",v===I?null:v===l&&I===f?m:(f=I,m=e(l=v,E)))}}function lu(t,e,n){var l,f,m;return function(){var v,E=n(this),I;return E==null?void this.removeAttributeNS(t.space,t.local):(v=this.getAttributeNS(t.space,t.local),I=E+"",v===I?null:v===l&&I===f?m:(f=I,m=e(l=v,E)))}}function Di(t,e){var n=Lt(t),l=n==="transform"?Xr:ar;return this.attrTween(t,typeof e=="function"?(n.local?lu:uu)(n,l,ue(this,"attr."+t,e)):e==null?(n.local?su:iu)(n):(n.local?ou:au)(n,l,e))}function hu(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function fu(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function cu(t,e){var n,l;function f(){var m=e.apply(this,arguments);return m!==l&&(n=(l=m)&&fu(t,m)),n}return f._value=e,f}function du(t,e){var n,l;function f(){var m=e.apply(this,arguments);return m!==l&&(n=(l=m)&&hu(t,m)),n}return f._value=e,f}function Li(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var l=Lt(t);return this.tween(n,(l.local?cu:du)(l,e))}function pu(t,e){return function(){Se(this,t).delay=+e.apply(this,arguments)}}function mu(t,e){return e=+e,function(){Se(this,t).delay=e}}function Pi(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?pu:mu)(e,t)):ut(this.node(),e).delay}function vu(t,e){return function(){ct(this,t).duration=+e.apply(this,arguments)}}function gu(t,e){return e=+e,function(){ct(this,t).duration=e}}function qi(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?vu:gu)(e,t)):ut(this.node(),e).duration}function xu(t,e){if(typeof e!="function")throw new Error;return function(){ct(this,t).ease=e}}function Fi(t){var e=this._id;return arguments.length?this.each(xu(e,t)):ut(this.node(),e).ease}function yu(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;ct(this,t).ease=n}}function Hi(t){if(typeof t!="function")throw new Error;return this.each(yu(this._id,t))}function ji(t){typeof t!="function"&&(t=ve(t));for(var e=this._groups,n=e.length,l=new Array(n),f=0;f<n;++f)for(var m=e[f],v=m.length,E=l[f]=[],I,C=0;C<v;++C)(I=m[C])&&t.call(I,I.__data__,C,m)&&E.push(I);return new mt(l,this._parents,this._name,this._id)}function Xi(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,l=e.length,f=n.length,m=Math.min(l,f),v=new Array(l),E=0;E<m;++E)for(var I=e[E],C=n[E],S=I.length,N=v[E]=new Array(S),R,P=0;P<S;++P)(R=I[P]||C[P])&&(N[P]=R);for(;E<l;++E)v[E]=e[E];return new mt(v,this._parents,this._name,this._id)}function _u(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function bu(t,e,n){var l,f,m=_u(e)?Se:ct;return function(){var v=m(this,t),E=v.on;E!==l&&(f=(l=E).copy()).on(e,n),v.on=f}}function Yi(t,e){var n=this._id;return arguments.length<2?ut(this.node(),n).on.on(t):this.each(bu(n,t,e))}function wu(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function Gi(){return this.on("end.remove",wu(this._id))}function Ui(t){var e=this._name,n=this._id;typeof t!="function"&&(t=te(t));for(var l=this._groups,f=l.length,m=new Array(f),v=0;v<f;++v)for(var E=l[v],I=E.length,C=m[v]=new Array(I),S,N,R=0;R<I;++R)(S=E[R])&&(N=t.call(S,S.__data__,R,E))&&("__data__"in S&&(N.__data__=S.__data__),C[R]=N,Kt(C[R],e,n,R,C,ut(S,n)));return new mt(m,this._parents,e,n)}function Wi(t){var e=this._name,n=this._id;typeof t!="function"&&(t=me(t));for(var l=this._groups,f=l.length,m=[],v=[],E=0;E<f;++E)for(var I=l[E],C=I.length,S,N=0;N<C;++N)if(S=I[N]){for(var R=t.call(S,S.__data__,N,I),P,q=ut(S,n),K=0,it=R.length;K<it;++K)(P=R[K])&&Kt(P,e,n,K,R,q);m.push(R),v.push(S)}return new mt(m,v,e,n)}var Eu=Pt.prototype.constructor;function Ki(){return new Eu(this._groups,this._parents)}function Iu(t,e){var n,l,f;return function(){var m=Ut(this,t),v=(this.style.removeProperty(t),Ut(this,t));return m===v?null:m===n&&v===l?f:f=e(n=m,l=v)}}function Zi(t){return function(){this.style.removeProperty(t)}}function Cu(t,e,n){var l,f=n+"",m;return function(){var v=Ut(this,t);return v===f?null:v===l?m:m=e(l=v,n)}}function Mu(t,e,n){var l,f,m;return function(){var v=Ut(this,t),E=n(this),I=E+"";return E==null&&(I=E=(this.style.removeProperty(t),Ut(this,t))),v===I?null:v===l&&I===f?m:(f=I,m=e(l=v,E))}}function Bu(t,e){var n,l,f,m="style."+e,v="end."+m,E;return function(){var I=ct(this,t),C=I.on,S=I.value[m]==null?E||(E=Zi(e)):void 0;(C!==n||f!==S)&&(l=(n=C).copy()).on(v,f=S),I.on=l}}function Ji(t,e,n){var l=(t+="")=="transform"?jr:ar;return e==null?this.styleTween(t,Iu(t,l)).on("end.style."+t,Zi(t)):typeof e=="function"?this.styleTween(t,Mu(t,l,ue(this,"style."+t,e))).each(Bu(this._id,t)):this.styleTween(t,Cu(t,l,e),n).on("end.style."+t,null)}function Su(t,e,n){return function(l){this.style.setProperty(t,e.call(this,l),n)}}function ku(t,e,n){var l,f;function m(){var v=e.apply(this,arguments);return v!==f&&(l=(f=v)&&Su(t,v,n)),l}return m._value=e,m}function Qi(t,e,n){var l="style."+(t+="");if(arguments.length<2)return(l=this.tween(l))&&l._value;if(e==null)return this.tween(l,null);if(typeof e!="function")throw new Error;return this.tween(l,ku(t,e,n??""))}function Vu(t){return function(){this.textContent=t}}function zu(t){return function(){var e=t(this);this.textContent=e??""}}function ts(t){return this.tween("text",typeof t=="function"?zu(ue(this,"text",t)):Vu(t==null?"":t+""))}function Ou(t){return function(e){this.textContent=t.call(this,e)}}function Au(t){var e,n;function l(){var f=t.apply(this,arguments);return f!==n&&(e=(n=f)&&Ou(f)),e}return l._value=t,l}function es(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,Au(t))}function rs(){for(var t=this._name,e=this._id,n=or(),l=this._groups,f=l.length,m=0;m<f;++m)for(var v=l[m],E=v.length,I,C=0;C<E;++C)if(I=v[C]){var S=ut(I,e);Kt(I,t,n,C,v,{time:S.time+S.delay+S.duration,delay:0,duration:S.duration,ease:S.ease})}return new mt(l,this._parents,t,n)}function ns(){var t,e,n=this,l=n._id,f=n.size();return new Promise(function(m,v){var E={value:v},I={value:function(){--f===0&&m()}};n.each(function(){var C=ct(this,l),S=C.on;S!==t&&(e=(t=S).copy(),e._.cancel.push(E),e._.interrupt.push(E),e._.end.push(I)),C.on=e}),f===0&&m()})}var Tu=0;function mt(t,e,n,l){this._groups=t,this._parents=e,this._name=n,this._id=l}function is(t){return Pt().transition(t)}function or(){return++Tu}var Ft=Pt.prototype;mt.prototype=is.prototype={constructor:mt,select:Ui,selectAll:Wi,selectChild:Ft.selectChild,selectChildren:Ft.selectChildren,filter:ji,merge:Xi,selection:Ki,transition:rs,call:Ft.call,nodes:Ft.nodes,node:Ft.node,size:Ft.size,empty:Ft.empty,each:Ft.each,on:Yi,attr:Di,attrTween:Li,style:Ji,styleTween:Qi,text:ts,textTween:es,remove:Gi,tween:Ri,delay:Pi,duration:qi,ease:Fi,easeVarying:Hi,end:ns,[Symbol.iterator]:Ft[Symbol.iterator]};function ur(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var $u={time:null,delay:0,duration:250,ease:ur};function Nu(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function ss(t){var e,n;t instanceof mt?(e=t._id,t=t._name):(e=or(),(n=$u).time=Me(),t=t==null?null:t+"");for(var l=this._groups,f=l.length,m=0;m<f;++m)for(var v=l[m],E=v.length,I,C=0;C<E;++C)(I=v[C])&&Kt(I,t,e,C,v,n||Nu(I,e));return new mt(l,this._parents,t,e)}Pt.prototype.interrupt=Ni;Pt.prototype.transition=ss;var{abs:tp,max:ep,min:rp}=Math;function as(t){return[+t[0],+t[1]]}function Ru(t){return[as(t[0]),as(t[1])]}var np={name:"x",handles:["w","e"].map(Ur),input:function(t,e){return t==null?null:[[+t[0],e[0][1]],[+t[1],e[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},ip={name:"y",handles:["n","s"].map(Ur),input:function(t,e){return t==null?null:[[e[0][0],+t[0]],[e[1][0],+t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},sp={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(Ur),input:function(t){return t==null?null:Ru(t)},output:function(t){return t}};function Ur(t){return{type:t}}var ke=t=>()=>t;function Wr(t,{sourceEvent:e,target:n,transform:l,dispatch:f}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:l,enumerable:!0,configurable:!0},_:{value:f}})}function At(t,e,n){this.k=t,this.x=e,this.y=n}At.prototype={constructor:At,scale:function(t){return t===1?this:new At(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new At(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Ve=new At(1,0,0);ze.prototype=At.prototype;function ze(t){for(;!t.__zoom;)if(!(t=t.parentNode))return Ve;return t.__zoom}function lr(t){t.stopImmediatePropagation()}function le(t){t.preventDefault(),t.stopImmediatePropagation()}function Du(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function Lu(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function os(){return this.__zoom||Ve}function Pu(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function qu(){return navigator.maxTouchPoints||"ontouchstart"in this}function Fu(t,e,n){var l=t.invertX(e[0][0])-n[0][0],f=t.invertX(e[1][0])-n[1][0],m=t.invertY(e[0][1])-n[0][1],v=t.invertY(e[1][1])-n[1][1];return t.translate(f>l?(l+f)/2:Math.min(0,l)||Math.max(0,f),v>m?(m+v)/2:Math.min(0,m)||Math.max(0,v))}function Kr(){var t=Du,e=Lu,n=Fu,l=Pu,f=qu,m=[0,1/0],v=[[-1/0,-1/0],[1/0,1/0]],E=250,I=Yr,C=pe("start","zoom","end"),S,N,R,P=500,q=150,K=0,it=10;function Y(M){M.property("__zoom",os).on("wheel.zoom",Ht,{passive:!1}).on("mousedown.zoom",jt).on("dblclick.zoom",Xt).filter(f).on("touchstart.zoom",fe).on("touchmove.zoom",pr).on("touchend.zoom touchcancel.zoom",mr).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}Y.transform=function(M,F,O,H){var G=M.selection?M.selection():M;G.property("__zoom",os),M!==G?xt(M,F,O,H):G.interrupt().each(function(){vt(this,arguments).event(H).start().zoom(null,typeof F=="function"?F.apply(this,arguments):F).end()})},Y.scaleBy=function(M,F,O,H){Y.scaleTo(M,function(){var G=this.__zoom.k,U=typeof F=="function"?F.apply(this,arguments):F;return G*U},O,H)},Y.scaleTo=function(M,F,O,H){Y.transform(M,function(){var G=e.apply(this,arguments),U=this.__zoom,W=O==null?wt(G):typeof O=="function"?O.apply(this,arguments):O,Q=U.invert(W),rt=typeof F=="function"?F.apply(this,arguments):F;return n(dt(lt(U,rt),W,Q),G,v)},O,H)},Y.translateBy=function(M,F,O,H){Y.transform(M,function(){return n(this.__zoom.translate(typeof F=="function"?F.apply(this,arguments):F,typeof O=="function"?O.apply(this,arguments):O),e.apply(this,arguments),v)},null,H)},Y.translateTo=function(M,F,O,H,G){Y.transform(M,function(){var U=e.apply(this,arguments),W=this.__zoom,Q=H==null?wt(U):typeof H=="function"?H.apply(this,arguments):H;return n(Ve.translate(Q[0],Q[1]).scale(W.k).translate(typeof F=="function"?-F.apply(this,arguments):-F,typeof O=="function"?-O.apply(this,arguments):-O),U,v)},H,G)};function lt(M,F){return F=Math.max(m[0],Math.min(m[1],F)),F===M.k?M:new At(F,M.x,M.y)}function dt(M,F,O){var H=F[0]-O[0]*M.k,G=F[1]-O[1]*M.k;return H===M.x&&G===M.y?M:new At(M.k,H,G)}function wt(M){return[(+M[0][0]+ +M[1][0])/2,(+M[0][1]+ +M[1][1])/2]}function xt(M,F,O,H){M.on("start.zoom",function(){vt(this,arguments).event(H).start()}).on("interrupt.zoom end.zoom",function(){vt(this,arguments).event(H).end()}).tween("zoom",function(){var G=this,U=arguments,W=vt(G,U).event(H),Q=e.apply(G,U),rt=O==null?wt(Q):typeof O=="function"?O.apply(G,U):O,It=Math.max(Q[1][0]-Q[0][0],Q[1][1]-Q[0][1]),ot=G.__zoom,yt=typeof F=="function"?F.apply(G,U):F,Mt=I(ot.invert(rt).concat(It/ot.k),yt.invert(rt).concat(It/yt.k));return function(_t){if(_t===1)_t=yt;else{var Bt=Mt(_t),ce=It/Bt[2];_t=new At(ce,rt[0]-Bt[0]*ce,rt[1]-Bt[1]*ce)}W.zoom(null,_t)}})}function vt(M,F,O){return!O&&M.__zooming||new Et(M,F)}function Et(M,F){this.that=M,this.args=F,this.active=0,this.sourceEvent=null,this.extent=e.apply(M,F),this.taps=0}Et.prototype={event:function(M){return M&&(this.sourceEvent=M),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(M,F){return this.mouse&&M!=="mouse"&&(this.mouse[1]=F.invert(this.mouse[0])),this.touch0&&M!=="touch"&&(this.touch0[1]=F.invert(this.touch0[0])),this.touch1&&M!=="touch"&&(this.touch1[1]=F.invert(this.touch1[0])),this.that.__zoom=F,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(M){var F=bt(this.that).datum();C.call(M,this.that,new Wr(M,{sourceEvent:this.sourceEvent,target:Y,type:M,transform:this.that.__zoom,dispatch:C}),F)}};function Ht(M,...F){if(!t.apply(this,arguments))return;var O=vt(this,F).event(M),H=this.__zoom,G=Math.max(m[0],Math.min(m[1],H.k*Math.pow(2,l.apply(this,arguments)))),U=qt(M);if(O.wheel)(O.mouse[0][0]!==U[0]||O.mouse[0][1]!==U[1])&&(O.mouse[1]=H.invert(O.mouse[0]=U)),clearTimeout(O.wheel);else{if(H.k===G)return;O.mouse=[U,H.invert(U)],Zt(this),O.start()}le(M),O.wheel=setTimeout(W,q),O.zoom("mouse",n(dt(lt(H,G),O.mouse[0],O.mouse[1]),O.extent,v));function W(){O.wheel=null,O.end()}}function jt(M,...F){if(R||!t.apply(this,arguments))return;var O=M.currentTarget,H=vt(this,F,!0).event(M),G=bt(M.view).on("mousemove.zoom",rt,!0).on("mouseup.zoom",It,!0),U=qt(M,O),W=M.clientX,Q=M.clientY;Tr(M.view),lr(M),H.mouse=[U,this.__zoom.invert(U)],Zt(this),H.start();function rt(ot){if(le(ot),!H.moved){var yt=ot.clientX-W,Mt=ot.clientY-Q;H.moved=yt*yt+Mt*Mt>K}H.event(ot).zoom("mouse",n(dt(H.that.__zoom,H.mouse[0]=qt(ot,O),H.mouse[1]),H.extent,v))}function It(ot){G.on("mousemove.zoom mouseup.zoom",null),$r(ot.view,H.moved),le(ot),H.event(ot).end()}}function Xt(M,...F){if(t.apply(this,arguments)){var O=this.__zoom,H=qt(M.changedTouches?M.changedTouches[0]:M,this),G=O.invert(H),U=O.k*(M.shiftKey?.5:2),W=n(dt(lt(O,U),H,G),e.apply(this,F),v);le(M),E>0?bt(this).transition().duration(E).call(xt,W,H,M):bt(this).call(Y.transform,W,H,M)}}function fe(M,...F){if(t.apply(this,arguments)){var O=M.touches,H=O.length,G=vt(this,F,M.changedTouches.length===H).event(M),U,W,Q,rt;for(lr(M),W=0;W<H;++W)Q=O[W],rt=qt(Q,this),rt=[rt,this.__zoom.invert(rt),Q.identifier],G.touch0?!G.touch1&&G.touch0[2]!==rt[2]&&(G.touch1=rt,G.taps=0):(G.touch0=rt,U=!0,G.taps=1+!!S);S&&(S=clearTimeout(S)),U&&(G.taps<2&&(N=rt[0],S=setTimeout(function(){S=null},P)),Zt(this),G.start())}}function pr(M,...F){if(this.__zooming){var O=vt(this,F).event(M),H=M.changedTouches,G=H.length,U,W,Q,rt;for(le(M),U=0;U<G;++U)W=H[U],Q=qt(W,this),O.touch0&&O.touch0[2]===W.identifier?O.touch0[0]=Q:O.touch1&&O.touch1[2]===W.identifier&&(O.touch1[0]=Q);if(W=O.that.__zoom,O.touch1){var It=O.touch0[0],ot=O.touch0[1],yt=O.touch1[0],Mt=O.touch1[1],_t=(_t=yt[0]-It[0])*_t+(_t=yt[1]-It[1])*_t,Bt=(Bt=Mt[0]-ot[0])*Bt+(Bt=Mt[1]-ot[1])*Bt;W=lt(W,Math.sqrt(_t/Bt)),Q=[(It[0]+yt[0])/2,(It[1]+yt[1])/2],rt=[(ot[0]+Mt[0])/2,(ot[1]+Mt[1])/2]}else if(O.touch0)Q=O.touch0[0],rt=O.touch0[1];else return;O.zoom("touch",n(dt(W,Q,rt),O.extent,v))}}function mr(M,...F){if(this.__zooming){var O=vt(this,F).event(M),H=M.changedTouches,G=H.length,U,W;for(lr(M),R&&clearTimeout(R),R=setTimeout(function(){R=null},P),U=0;U<G;++U)W=H[U],O.touch0&&O.touch0[2]===W.identifier?delete O.touch0:O.touch1&&O.touch1[2]===W.identifier&&delete O.touch1;if(O.touch1&&!O.touch0&&(O.touch0=O.touch1,delete O.touch1),O.touch0)O.touch0[1]=this.__zoom.invert(O.touch0[0]);else if(O.end(),O.taps===2&&(W=qt(W,this),Math.hypot(N[0]-W[0],N[1]-W[1])<it)){var Q=bt(this).on("dblclick.zoom");Q&&Q.apply(this,arguments)}}}return Y.wheelDelta=function(M){return arguments.length?(l=typeof M=="function"?M:ke(+M),Y):l},Y.filter=function(M){return arguments.length?(t=typeof M=="function"?M:ke(!!M),Y):t},Y.touchable=function(M){return arguments.length?(f=typeof M=="function"?M:ke(!!M),Y):f},Y.extent=function(M){return arguments.length?(e=typeof M=="function"?M:ke([[+M[0][0],+M[0][1]],[+M[1][0],+M[1][1]]]),Y):e},Y.scaleExtent=function(M){return arguments.length?(m[0]=+M[0],m[1]=+M[1],Y):[m[0],m[1]]},Y.translateExtent=function(M){return arguments.length?(v[0][0]=+M[0][0],v[1][0]=+M[1][0],v[0][1]=+M[0][1],v[1][1]=+M[1][1],Y):[[v[0][0],v[0][1]],[v[1][0],v[1][1]]]},Y.constrain=function(M){return arguments.length?(n=M,Y):n},Y.duration=function(M){return arguments.length?(E=+M,Y):E},Y.interpolate=function(M){return arguments.length?(I=M,Y):I},Y.on=function(){var M=C.on.apply(C,arguments);return M===C?Y:M},Y.clickDistance=function(M){return arguments.length?(K=(M=+M)*M,Y):Math.sqrt(K)},Y.tapDistance=function(M){return arguments.length?(it=+M,Y):it},Y}var ht=ka(ls());Array.prototype.remove=function(){for(var t,e=arguments,n=e.length,l;n&&this.length;)for(t=e[--n];(l=this.indexOf(t))!==-1;)this.splice(l,1);return this};function ju(t,e,n="_",l=void 0,f=14,m=void 0,v=13,E="central"){if(!e)return;let I=t.append("text").attr("class",l).attr("dominant-baseline",E),C=e.split(n);if(m||(m=-f*(C.length-1)/2),C!=null)for(let S=0;S<C.length;S++)I.append("tspan").text(C[S]).attr("dy",S==0?m:f).attr("x",v)}var cr=class{constructor(e,n=e.start){if(e.links.length>0)this.dag=(0,ht.dagConnect)()(e.links),this.dag.id!=null&&(this.root=this.dag.copy(),this.root.id=void 0,this.root.children=[this.dag],this.dag=this.root),this.nodes=this.dag.descendants().map(l=>{if(l.id in e.unions)return new Oe(l,e.unions[l.id],this);if(l.id in e.persons)return new he(l,e.persons[l.id],this)}),this.nodes.forEach(l=>l._children=l._children.map(f=>f.ftnode)),this.number_nodes=0,this.nodes.forEach(l=>{l.id=l.id||this.number_nodes,this.number_nodes++}),this.root=this.find_node_by_id(n),this.root.visible=!0,this.dag.children=[this.root];else if(Object.values(e.persons).length>0){let l=e.persons[n];this.root=new ht.dagNode(n,l),this.root=new he(this.root,l,this),this.root.visible=!0,this.number_nodes=1,this.nodes=[this.root],this.dag=new ht.dagNode(void 0,{}),this.dag.children=this.root}}update_roots(){this.dag.children=[this.root];let e=this;function n(l){l.get_visible_inserted_neighbors().forEach(f=>{f.is_root()&&e.dag.children.push(f),n(f)})}n(this.root)}find_node_by_id(e){return this.nodes.find(n=>n.id==e)}},dr=class extends ht.dagNode{is_extendable(){return this.get_neighbors().filter(e=>!e.visible).length>0}get_visible_neighbors(){return this.get_neighbors().filter(e=>e.visible)}get_visible_inserted_neighbors(){return this.get_visible_neighbors().filter(e=>this.inserted_nodes.includes(e))}},Oe=class extends dr{constructor(e,n,l){super(e.id,n),e.ftnode=this,this.ft_datahandler=l,this._children=e.children,this.children=[],this._childLinkData=e._childLinkData,this.inserted_nodes=[],this.inserted_links=[],this.visible=!1}get_neighbors(){return this.get_parents().concat(this.get_children())}get_parents(){var e=this.data.partner.map(n=>this.ft_datahandler.find_node_by_id(n)).filter(n=>n!=null);return e||[]}get_hidden_parents(){return this.get_parents().filter(e=>!e.visible)}get_visible_parents(){return this.get_parents().filter(e=>e.visible)}get_children(){var e=[];return e=this.children.concat(this._children),e=e.filter(n=>n!=null),e}get_hidden_children(){return this.get_children().filter(e=>!e.visible)}get_visible_children(){return this.get_children().filter(e=>e.visible)}show_child(e){this._children.includes(e)||console.warn("Child node not in this' _children array."),this.children.push(e),this._children.remove(e),e.visible?this.inserted_links.push([this,e]):(e.visible=!0,this.inserted_nodes.push(e))}show_parent(e){e._children.includes(this)||console.warn("This node not in parent's _children array."),e.children.push(this),e._children.remove(this),e.visible?this.inserted_links.push([e,this]):(e.visible=!0,this.inserted_nodes.push(e))}show(){this.visible=!0,this.get_children().forEach(e=>{this.show_child(e)}),this.get_parents().forEach(e=>{this.show_parent(e)})}get_visible_inserted_children(){return this.children.filter(e=>this.inserted_nodes.includes(e))}get_visible_inserted_parents(){return this.get_visible_parents().filter(e=>this.inserted_nodes.includes(e))}is_root(){return!1}hide_child(e){this.children.includes(e)||console.warn("Child node not in this's children array."),e.visible=!1,this._children.push(e),this.children.remove(e),this.inserted_nodes.remove(e)}hide_parent(e){e.children.includes(this)||console.warn("This node not in parent's children array."),e.visible=!1,e._children.push(this),e.children.remove(this),this.inserted_nodes.remove(e)}hide(){this.visible=!1,this.get_visible_inserted_children().forEach(e=>{this.hide_child(e)}),this.get_visible_inserted_parents().forEach(e=>{this.hide_parent(e)}),this.inserted_links.forEach(e=>{let n=e[0],l=e[1];this==n?(this._children.push(l),this.children.remove(l)):this==l&&(n._children.push(this),n.children.remove(this))}),this.inserted_links=[]}get_own_unions(){return[]}get_parent_unions(){return[]}get_name(){}get_birth_year(){}get_birth_place(){}get_death_year(){}get_death_place(){}is_union(){return!0}add_parent(e){let n=e.id||"p"+ ++this.ft_datahandler.number_nodes,l=new ht.dagNode(n,e),f=new he(l,e,this.ft_datahandler);return"parent_union"in e||(e.parent_union=void 0),"own_unions"in e||(e.own_unions=[this.id],f._childLinkData=[[f.id,this.id]],f._children.push(this)),f.data=e,this.ft_datahandler.nodes.push(f),e.own_unions.includes(this.id)||e.own_unions.push(this.id),this.data.partner.includes(f.id)||this.data.partner.push(f.id),this.show_parent(f),this.ft_datahandler.update_roots(),f}add_child(e){let n=e.id||"p"+ ++this.ft_datahandler.number_nodes,l=new ht.dagNode(n,e),f=new he(l,e,this.ft_datahandler);return"parent_union"in e||(e.parent_union=this.id),"own_unions"in e||(e.own_unions=[]),f.data=e,this.ft_datahandler.nodes.push(f),!e.parent_union==this.id&&e.parent_union==this.id,this.data.children.includes(f.id)||this.data.children.push(f.id),this._childLinkData.includes([this.id,f.id])||this._childLinkData.push([this.id,f.id]),this.show_child(f),f}},he=class extends dr{constructor(e,n,l){super(e.id,n),e.ftnode=this,this.ft_datahandler=l,this._children=e.children,this.children=[],this._childLinkData=e._childLinkData,this.inserted_nodes=[],this.inserted_links=[],this.visible=!1}get_name(){return this.data.name}get_birth_year(){return this.data.birthyear}get_birth_place(){return this.data.birthplace}get_death_year(){return this.data.deathyear}get_death_place(){return this.data.deathplace}get_neighbors(){return this.get_own_unions().concat(this.get_parent_unions())}get_parent_unions(){var e=[this.data.parent_union].map(l=>this.ft_datahandler.find_node_by_id(l)).filter(l=>l!=null),n=this.data.parent_union;return e||[]}get_hidden_parent_unions(){return this.get_parent_unions().filter(e=>!e.visible)}get_visible_parent_unions(){return this.get_parent_unions().filter(e=>e.visible)}get_visible_inserted_parent_unions(){return this.get_visible_parent_unions().filter(e=>this.inserted_nodes.includes(e))}is_root(){return this.get_visible_parent_unions().length==0}is_union(){return!1}get_own_unions(){var e=(this.data.own_unions??[]).map(n=>this.ft_datahandler.find_node_by_id(n)).filter(n=>n!=null);return e||[]}get_hidden_own_unions(){return this.get_own_unions().filter(e=>!e.visible)}get_visible_own_unions(){return this.get_own_unions().filter(e=>e.visible)}get_visible_inserted_own_unions(){return this.get_visible_own_unions().filter(e=>this.inserted_nodes.includes(e))}get_parents(){var e=[];this.get_parent_unions().forEach(n=>e=e.concat(n.get_parents()))}get_other_partner(e){var n=e.partner.find(l=>l!=this.id&l!=null);return all_nodes.find(l=>l.id==n)}get_partners(){var e=[];return this.get_own_unions().forEach(n=>{e.push(this.get_other_partner(n.data))}),e.filter(n=>n!=null)}get_children(){var e=[];return this.get_own_unions().forEach(n=>e=e.concat(getChildren(n))),e=e.filter(n=>n!=null),e}show_union(e){e.show(),this.inserted_nodes.push(e)}hide_own_union(e){e.hide(),this.inserted_nodes.remove(e)}hide_parent_union(e){e.hide()}show(){this.get_hidden_own_unions().forEach(e=>this.show_union(e)),this.get_hidden_parent_unions().forEach(e=>this.show_union(e))}hide(){this.get_visible_inserted_own_unions().forEach(e=>this.hide_own_union(e)),this.get_visible_inserted_parent_unions().forEach(e=>this.hide_parent_union(e))}click(){this.is_extendable()?this.show():this.hide(),this.ft_datahandler.update_roots()}add_own_union(e){let n=e.id||"u"+ ++this.ft_datahandler.number_nodes,l=new ht.dagNode(n,e),f=new Oe(l,e,this.ft_datahandler);return"partner"in e||(e.partner=[this.id]),"children"in e||(e.children=[],f._childLinkData=[]),f.data=e,this.ft_datahandler.nodes.push(f),e.partner.includes(this.id)||e.partner.push(this.id),this.data.own_unions.includes(f.id)||this.data.own_unions.push(f.id),this._childLinkData.includes([this.id,f.id])||this._childLinkData.push([this.id,f.id]),this.show_union(f),f}add_parent_union(e){let n=e.id||"u"+ ++this.ft_datahandler.number_nodes,l=new ht.dagNode(n,e),f=new Oe(l,e,this.ft_datahandler);return"partner"in e||(e.partner=[]),"children"in e||(e.children=[this.id],f._childLinkData=[[f.id,this.id]],f._children.push(this)),f.data=e,this.ft_datahandler.nodes.push(f),e.children.includes(this.id)||e.children.push(this.id),this.data.parent_union=f.id,this.show_union(f),this.ft_datahandler.update_roots(),f}},Rt=class{constructor(e,n,l,f){this.ft_datahandler=e,this.svg=n,this._orientation=null,this.link_css_class="link",this.g=this.svg.append("g"),this.zoom=Kr().on("zoom",v=>this.g.attr("transform",v.transform)),this.svg.call(this.zoom),this._tooltip_div=bt("body").append("div").attr("class","tooltip").style("opacity",0),this.tooltip(Rt.default_tooltip_func),this.layout=(0,ht.sugiyama)().nodeSize([120,120]).layering((0,ht.layeringSimplex)()).decross(ht.decrossOpt).coord((0,ht.coordVert)()),this.orientation("horizontal"),this.transition_duration(750),this.link_path(Rt.default_link_path_func),this.node_label(Rt.default_node_label_func),this.node_size(Rt.default_node_size_func),this.node_class(Rt.default_node_class_func);let m=this.default_root_position();this.ft_datahandler.root.x0=l||m[0],this.ft_datahandler.root.y0=f||m[1]}default_root_position(){return[this.svg.attr("width")/2,this.svg.attr("height")/2]}orientation(e){return e?(this._orientation=e,this):this.orientation}node_separation(e){return e?(this.layout.nodeSize(e),this):this.layout.nodeSize()}layering(e){return e?(this.layout.layering(e),this):this.layout.layering()}decross(e){return e?(this.layout.decross(e),this):this.layout.decross()}coord(e){return e?(this.layout.coord(e),this):this.layout.coord()}transition_duration(e){return e!=0&!e?this._transition_duration:(this._transition_duration=e,this)}static default_tooltip_func(e){if(!e.is_union()){var n=`
                <span style='margin-left: 2.5px;'><b>`+e.get_name()+`</b></span><br>
                <table style="margin-top: 2.5px;">
                        <tr><td>born</td><td>`+(e.get_birth_year()||"?")+" in "+(e.data.birthplace||"?")+`</td></tr>
                        <tr><td>died</td><td>`+(e.get_death_year()||"?")+" in "+(e.data.deathplace||"?")+`</td></tr>
                </table>
                `;return n.replace(new RegExp("null","g"),"?")}}tooltip(e){return e?(this.show_tooltips=!0,this._tooltip_func=e):this.show_tooltips=!1,this}static default_node_label_func(e){if(!e.is_union())return e.get_name()+Rt.label_delimiter+(e.get_birth_year()||"?")+" - "+(e.get_death_year()||"?")}node_label(e){return e&&(this.node_label_func=e),this}static default_node_class_func(e){if(!e.is_union())return e.is_extendable()?"person extendable":"person non-extendable"}node_class(e){return e&&(this.node_class_func=e),this}static default_node_size_func(e){return e.is_union()?0:10}node_size(e){return e&&(this.node_size_func=e),this}static default_link_path_func(e,n){function l(m,v){return`M ${m.x} ${m.y}
            C ${m.x} ${(m.y+v.y)/2},
            ${v.x} ${(m.y+v.y)/2},
            ${v.x} ${v.y}`}function f(m,v){return`M ${m.x} ${m.y}
            C ${(m.x+v.x)/2} ${m.y},
              ${(m.x+v.x)/2} ${v.y},
              ${v.x} ${v.y}`}return this._orientation=="vertical"?l(e,n):f(e,n)}link_path(e){return e&&(this.link_path_func=e),this}static make_unique_link_id(e){return e.id||e.source.id+"_"+e.target.id}draw(e=this.ft_datahandler.root){let n=this.ft_datahandler.dag.descendants(),l=this.ft_datahandler.dag.links();if(this.layout(this.ft_datahandler.dag),this._orientation=="horizontal"){var f=null;n.forEach(function(q){f=q.x,q.x=q.y,q.y=f})}var m=this.g.selectAll("g.node").data(n,q=>q.id),v=m.enter().append("g").attr("class","node").attr("transform",q=>"translate("+e.x0+","+e.y0+")").on("click",(q,K)=>{K.click(),this.draw(K)}).attr("visible",!0);if(this.show_tooltips){let q=this._tooltip_div,K=this._tooltip_func;v.on("mouseover",function(it,Y){q.transition().duration(200).style("opacity",void 0),q.html(K(Y));let lt=q.node().getBoundingClientRect().height;q.style("left",it.pageX+10+"px").style("top",it.pageY-lt/2+"px")}).on("mouseout",function(it){q.transition().duration(500).style("opacity",0)})}v.append("circle").attr("class",this.node_class_func).attr("r",1e-6);let E=this;v.each(function(q){ju(bt(this),E.node_label_func(q),Rt.label_delimiter,"node-label")});var I=v.merge(m);I.transition().duration(this.transition_duration()).attr("transform",q=>"translate("+q.x+","+q.y+")"),I.select(".node circle").attr("r",this.node_size_func).attr("class",this.node_class_func).attr("cursor","pointer");var C=m.exit().transition().duration(this.transition_duration()).attr("transform",q=>"translate("+e.x+","+e.y+")").attr("visible",!1).remove();C.select("circle").attr("r",1e-6),C.select("text").style("fill-opacity",1e-6);var S=this.g.selectAll("path."+this.link_css_class).data(l,Rt.make_unique_link_id),N=S.enter().insert("path","g").attr("class",this.link_css_class).attr("d",q=>{var K={x:e.x0,y:e.y0};return this.link_path_func(K,K)}),R=N.merge(S);R.transition().duration(this.transition_duration()).attr("d",q=>this.link_path_func(q.source,q.target));var P=S.exit().transition().duration(this.transition_duration()).attr("d",q=>{var K={x:e.x,y:e.y};return this.link_path_func(K,K)}).remove();this.svg.transition().duration(this.transition_duration()).call(this.zoom.transform,ze(this.g.node()).translate(-(e.x-e.x0),-(e.y-e.y0))),n.forEach(function(q){q.x0=q.x,q.y0=q.y})}clear(){this.g.selectAll("*").remove()}},fr=Rt;yn(fr,"label_delimiter","_");var Zr=class extends fr{constructor(e,n){let l=new cr(e);super(l,n)}get root(){return this.ft_datahandler.root}draw_data(e){var n=null,l=null;this.root!==null?[n,l]=[this.root.x0,this.root.y0]:[n,l]=this.default_root_position(),this.ft_datahandler=new cr(e),this.root.x0=n,this.root.y0=l,this.clear(),this.draw()}async load_data(e){let{data:n}=await import(e);this.draw_data(n)}};export{Zr as default};
